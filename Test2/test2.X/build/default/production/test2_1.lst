MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001         list p=16f877 ; list directive to define processor
                      00002         #include <p16f877.inc> ; processor specific variable definitions
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC16F877 processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2012 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      00540         LIST
2007   3F72           00003         __CONFIG _CP_OFF & _WDT_OFF & _BODEN_ON & _PWRTE_ON & _HS_OSC & _WRT_ENABLE_ON & _CPD_OFF & _LVP
                            _OFF
                      00004         #include <common.inc>
                      00001         ;extern LCD_init, LCD_clear, LCD_line2s, LCD_out, LCD_wt, delay50us, delay5ms, delayX5msm, delay
                            100ms, delayX100msm, delay1sl
                      00002 
                      00003 
                      00004         #define DEBUG
                      00005         #define NULL 0x00 ; must not change
                      00006         #define FALSE 0x00 ; must not change
                      00007         #define TRUE 0xFF ; must not change
                      00008         #define KEYPAD_DA PORTB, 1
                      00009         #define SMOTOR_S0 PORTD, 0
                      00010         #define SMOTOR_S1 PORTD, 1
                      00011         #define SMOTOR_S2 PORTE, 0
                      00012         #define SMOTOR_S3 PORTE, 1
                      00013         #define SMOTOR_EN PORTE, 2
                      00014         #define VMOTOR_C0 PORTC, 0
                      00015         #define VMOTOR_C1 PORTC, 1
                      00016         #define IRLED PORTC, 2
                      00017         #define FB_TOP PORTC, 5
                      00018         ; #define FB_BOT PORTC, 6
                      00019         #define FB_ROW4 PORTC, 7
                      00020         #define LCD_RS PORTD, 2
                      00021         #define LCD_E PORTD, 3
                      00022         #define LCD_PORT PORTD
                      00023         #define CL_POS_BIT 0
                      00024         #define CL_FN_BIT 1
                      00025         #define CL_ERR_BIT 2
                      00026         #define STOP_BUT 0x0B ; stop buttom
                      00027         #define PHASE_HDINIT 0 ; Phase 0: Hardware Initialization/Reset
                      00028         #define PHASE_RTCINIT 1 ; Phase 1: RTC Initialization/Reset
                      00029         #define PHASE_REALTIME 2 ; Phase 2: Real Time
                      00030         #define PHASE_NOREPORT 3 ; Phase 3: No Report
                      00031         #define PHASE_REPORT 4 ; Phase 4: Report Review
                      00032         #define PHASE_RUN 5 ; Phase 5: Inspection Run
                      00033         #define PHASE_FINISH 6 ; Phase 6: Inspection Finish
                      00034         ; pull-up diable, Timer0 internal clk, pos edge, 1:64
                      00035         #define INITVAL_OPTREG B'10000101'
                      00036         #define INITVAL_TRISA B'00101111'
                      00037         #define INITVAL_TRISB B'11110010'
                      00038         #define INITVAL_TRISC B'10100000' ;B'11100000'!!!!
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00039         #define INITVAL_TRISD B'00000000'
                      00040         #define INITVAL_TRISE B'00000000'
                      00041         #define INITVAL_ADCON0 B'10000001' ; 32Tosc, AN0, ADC on
                      00042         #define INITVAL_ADCON1 B'00000010' ; left justified, 5 channel, 0 Vref
                      00043 ;******************CONSTANTS****************************************************
  00000009            00044 MAXLINE EQU .9 ; (max "line_num" - 1) in report phase
  00000014            00045 MAXPOS EQU .20 ; total positions = ROWS*COLS
  00000004            00046 ROWS EQU .4 ; total 4 rows to move
  00000005            00047 COLS EQU .5 ; total 5 cols in a row
  00000003            00048 MAXCLINROW EQU .3 ; max number of CLs possible in a row
  0000001E            00049 DCDOWNDELAY EQU .30 ; * 0.1s == elapse time for DC motor to drive down
  0000001C            00050 SMOTOR_STEPS EQU .28 ; * 4 == # of steps that stepper motor need to turn
  00000006            00051 SMOTOR_SPD_F EQU .6 ; speed fact: speed = 1 step / (SMOTOR_SPD_F * 5ms)
  00000050            00052 THD_CL3LED EQU .80 ; threshold to distinguish between 2 LEDs and 3LEDS
  0000001C            00053 THD_IRLED EQU .28 ; threshold for infrared reflected light
  00000005            00054 THD_BG EQU .5 ; threshold for background variation (add to light_bg)
  0000000C            00055 MAXLOG EQU .12 ; max number of log
  00000006            00056 MAXLOGBANK EQU .6 ; max number of log per bank = MAXLOG/2
  00000010            00057 LOGLENGTH EQU .16 ; length of each log entry
  00000004            00058 LIGHTAVGX EQU .4 ; number of sample light sensor reading to be averaged
                      00059 ;******************MACROS*******************************************************
                      00060 BANK0 macro
                      00061         bcf STATUS, RP0
                      00062         endm
                      00063 BANK1 macro
                      00064         bsf STATUS, RP0
                      00065         endm
                      00066 BANK00 macro
                      00067         bcf STATUS, IRP
                      00068         bcf STATUS, RP1
                      00069         bcf STATUS, RP0
                      00070         endm
                      00071         ;BANK02 macro
                      00072         ; bsf STATUS, IRP
                      00073         ; bsf STATUS, RP1
                      00074         ; bcf STATUS, RP0
                      00075         ; endm
                      00076         ;
                      00077         ;BANK03 macro
                      00078         ; bsf STATUS, IRP
                      00079         ; bsf STATUS, RP1
                      00080         ; bsf STATUS, RP0
                      00081         ; endm
                      00082         ; Affect W!
                      00083 MOVFF macro dest, orig
                      00084         movf orig, w
                      00085         movwf dest
                      00086         endm
                      00087 ; Affect W!
                      00088 MOVLF macro dest, literal
                      00089         movlw literal
                      00090         movwf dest
                      00091         endm
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00092         
  0000                00005         extern LCD_init, LCD_clear, LCD_line2, LCD_out, LCD_wt
  0000                00006         extern delay50us, delay5ms, delayX5msm, delay100ms, delayX100msm, delay1sl
                      00007 ;******************VARIABLES****************************************************
                      00008         cblock 0x20
  00000020            00009                 phase ; 0 = realtime, 1 = report, 2 = run
  00000021            00010                 report_num
  00000022            00011                 line_num
  00000023            00012                 LCDline : .17 ; 16 + null
  00000034            00013                 temp ; only local use: must be discard before calling/jumping
  00000035            00014                 temp2
  00000036            00015                 temp3
  00000037            00016                 temp4
  00000038            00017                 temp5
  00000039            00018                 temp6
  0000003A            00019                 temp7
  0000003B            00020                 arg ; argument
  0000003C            00021                 arg2
  0000003D            00022                 literal_addr
  0000003E            00023                 rowleft ; how many rows left to inspect
  0000003F            00024                 result_addr ; adress to store result of current row in "layout"
  00000040            00025                 rt_year ; realtime
  00000041            00026                 rt_month
  00000042            00027                 rt_day
  00000043            00028                 rt_hour
  00000044            00029                 rt_min
  00000045            00030                 rt_sec
  00000046            00031                 st_year ; start
  00000047            00032                 st_month
  00000048            00033                 st_day
  00000049            00034                 st_hour
  0000004A            00035                 st_min
  0000004B            00036                 st_sec
  0000004C            00037                 end_hour
  0000004D            00038                 end_min
  0000004E            00039                 end_sec
  0000004F            00040                 runtime
  00000050            00041                 cl_total
  00000051            00042                 cl_pass
  00000052            00043                 cl_fail
  00000053            00044                 layout : .20 ; result
  00000067            00045                 smotor_dir ; direction of stepper motor
  00000068            00046                 log_total ; total numbers of reports available
  00000069            00047                 log_next ; index of where next report will be written
  0000006A            00048                 arith_temp ; arithmetic temp
  0000006B            00049                 arith_temp2
  0000006C            00050                 newsec ; a new second occur (Bool from interrupt)
                      00051         endc
                      00052         cblock 0xB0
  000000B0            00053                 light_bg : 5 ; background light intensity of current row
  000000B5            00054                 light_pos : 5 ; position reflected light intensity of current row
  000000BA            00055                 light_cl : 5 ; closet light LEDs light intensity of current row
  000000BF            00056                 light_off : 5 ; closet light off light intensity of current row
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00057         endc
                      00058 
                      00059         udata_shr
0000                  00060 w_temp res 1
0001                  00061 status_temp res 1
                      00062 ;pclath_temp res 1
0002                  00063 FSR_temp res 1
0003                  00064 rt_counter res 1 ; real time counter
0004                  00065 table_temp res 1
                      00066 ;******************MACROS*******************************************************
                      00067 DIVLW macro L
                      00068         movwf arith_temp
                      00069         movlw L
                      00070         call divfn
Warning[205]: Found directive in column 1. (endm)
                      00071 endm
                      00072 
                      00073 MODLW macro L
                      00074         movwf arith_temp
                      00075         movlw L
                      00076         call divfn
                      00077         movf arith_temp, w
Warning[205]: Found directive in column 1. (endm)
                      00078 endm
                      00079 
                      00080 MULLW macro L
                      00081         movwf arith_temp
                      00082         movlw L
                      00083         call mulfn
Warning[205]: Found directive in column 1. (endm)
                      00084 endm
                      00085 
                      00086 COPY_STRING macro string_table
                      00087         movlw string_table
                      00088         call copystring
Warning[205]: Found directive in column 1. (endm)
                      00089 endm
                      00090 
                      00091 COPY_LAYOUT macro rownum
                      00092         movlw rownum
                      00093         call copylayout
Warning[205]: Found directive in column 1. (endm)
                      00094 endm
                      00095 
                      00096 COPY_DEC1 macro decnumber
                      00097         movf decnumber, w
                      00098         movwf arg
                      00099         movlw 0x01
                      00100         movwf arg2
                      00101         call copydec
Warning[205]: Found directive in column 1. (endm)
                      00102 endm
                      00103 
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00104 COPY_DEC2 macro decnumber
                      00105         movf decnumber, w
                      00106         movwf arg
                      00107         movlw 0x02
                      00108         movwf arg2
                      00109         call copydec
Warning[205]: Found directive in column 1. (endm)
                      00110 endm
                      00111 
                      00112 COPY_DEC3 macro decnumber
                      00113         movf decnumber, w
                      00114         movwf arg
                      00115         movlw 0x03
                      00116         movwf arg2
                      00117         call copydec
Warning[205]: Found directive in column 1. (endm)
                      00118 endm
                      00119 
                      00120 TABLE macro
                      00121         local tablename
                      00122         movwf table_temp
                      00123         movlw HIGH tablename
                      00124         movwf PCLATH
                      00125         movf table_temp, w
                      00126         addlw LOW tablename
                      00127         btfsc STATUS, C
                      00128         incf PCLATH, f
                      00129         movwf PCL
                      00130         tablename
Warning[205]: Found directive in column 1. (endm)
                      00131 endm
                      00132 
                      00133 STORE_LIGHT macro addr
                      00134         movlw addr
                      00135         call lightsensor
Warning[205]: Found directive in column 1. (endm)
                      00136 endm
                      00137 
                      00138 IRLED_ON macro
                      00139         movlw 0x01
                      00140         call ledcontrol
Warning[205]: Found directive in column 1. (endm)
                      00141 endm
                      00142 
                      00143 IRLED_OFF macro
                      00144         movlw 0x00
                      00145         call ledcontrol
Warning[205]: Found directive in column 1. (endm)
                      00146 endm
                      00147 
                      00148 CALC_POS macro threshold
                      00149         movwf temp
                      00150         movlw threshold
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00151         movwf temp4
                      00152         call calcpos
Warning[205]: Found directive in column 1. (endm)
                      00153 endm
                      00154 
                      00155 PRINT_DOT macro
                      00156         MOVLF FSR, LCDline
                      00157         COPY_STRING str_dot
                      00158         call writeline
Warning[205]: Found directive in column 1. (endm)
                      00159 endm
                      00160 
                      00161 ;*******************************************************************************
                      00162 ;*******************************************************************************
                      00163         org 0x0000
0000   2???           00164         goto main
                      00165 
                      00166         org 0x0004
0004   2???           00167         goto interrupt
                      00168 
                      00169     org 0x0005 ; make sure literal table is in first 256 lines
0005                  00170 literal
0005   00B4           00171         movwf temp
0006   018A           00172         clrf PCLATH
0007   0834           00173         movf temp, w
0008   0082           00174         movwf PCL
                      00175         ; max length 16 dt "0123456789ABCDEF", 0
0009   3449 344E 3449 00176 str_init dt "INITIALIZING...", 0
       3454 3449 3441 
       344C 3449 345A 
       3449 344E 3447 
       342E 342E 342E 
       3400 
0019   344E 344F 3420 00177 str_noreport dt "NO REPORT", 0
       3452 3445 3450 
       344F 3452 3454 
       3400 
0023   3445 344E 3454 00178 str_enterymd dt "ENTER 20YYMMDD:",0
       3445 3452 3420 
       3432 3430 3459 
       3459 344D 344D 
       3444 3444 343A 
       3400 
0033   3445 344E 3454 00179 str_enterhms dt "ENTER hhmmss:", 0
       3445 3452 3420 
       3468 3468 346D 
       346D 3473 3473 
       343A 3400 
0041   3432 3430 3400 00180 str_yearhead dt "20", 0 ; all years like 20XX
0044   342D 3400      00181 str_dash dt "-", 0
0046   343A 3400      00182 str_colon dt ":", 0
0048   344C 344F 3447 00183 str_entry dt "LOG ENTRY: ",0
       3420 3445 344E 
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       3454 3452 3459 
       343A 3420 3400 
0054   3453 3454 3441 00184 str_start dt "START: ", 0
       3452 3454 343A 
       3420 3400 
005C   3446 3449 344E 00185 str_finish dt "FINISH: ", 0
       3449 3453 3448 
       343A 3420 3400 
0065   3452 3455 344E 00186 str_runtime dt "RUNTIME: ", 0
       3454 3449 344D 
       3445 343A 3420 
       3400 
006F   3473 3400      00187 str_s dt "s", 0 ; i.e. second
0071   3454 344F 3454 00188 str_total dt "TOTAL: ", 0
       3441 344C 343A 
       3420 3400 
0079   3450 3441 3453 00189 str_pass dt "PASS: ", 0
       3453 343A 3420 
       3400 
0080   3420 3446 3441 00190 str_fail dt " FAIL: ", 0
       3449 344C 343A 
       3420 3400 
0088   344C 3441 3459 00191 str_layout dt "LAYOUT:", 0
       344F 3455 3454 
       343A 3400 
0090   3420 3454 344F 00192 str_layout1 dt " TOP 1 ", 0
       3450 3420 3431 
       3420 3400 
0098   3420 3432 3420 00193 str_layout2 dt " 2 ", 0
       3400 
009C   3420 3433 3420 00194 str_layout3 dt " 3 ", 0
       3400 
00A0   3420 3442 344F 00195 str_layout4 dt " BOT 4 ", 0
       3454 3420 3434 
       3420 3400 
00A8   3452 3455 344E 00196 str_running dt "RUNNING", 0
       344E 3449 344E 
       3447 3400 
00B0   342E 3400      00197 str_dot dt ".", 0
00B2   3449 344E 3453 00198 str_insp_fin dt "INSPECTION FIN", 0
       3450 3445 3443 
       3454 3449 344F 
       344E 3420 3446 
       3449 344E 3400 
00C1   3445 344D 3445 00199 str_emerstop dt "EMERGENCY STOP", 0
       3452 3447 3445 
       344E 3443 3459 
       3420 3453 3454 
       344F 3450 3400 
00D0   3400           00200 str_null dt 0
                      00201 ; corresponds to the layout byte
00D1   3458 3446 3446 00202 char_layout dt "XFFPXFFP" ;"XF2P4567" ; "XFEPEEEE"
       3450 3458 3446 
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       3446 3450 
                      00203 ; corresponds to keypad
00D9   3431 3432 3433 00204 char_keynumber dt "123", 0, "456", 0, "789", 0, 0, "0", 0, 0
       3400 3434 3435 
       3436 3400 3437 
       3438 3439 3400 
       3400 3430 3400 
       3400 
00E9   342F 3400      00205 char_slash dt "/", 0
                      00206 ;????!!!!copy spaceX function
                      00207 
00EB                  00208 main
00EB   2???           00209         call init
00EC                  00210 keypoll
00EC   1886           00211         btfsc KEYPAD_DA
00ED   2???           00212         call keyresp
00EE   2???           00213         call keypad_timeout
00EF   2???           00214         goto keypoll
                      00215 
00F0                  00216 interrupt
00F0   00??           00217         movwf w_temp ; save W
00F1   0E03           00218         swapf STATUS, w ; save STATUS, note swapf will not affect STATUS
                      00219         BANK00
00F2   1383               M         bcf STATUS, IRP
00F3   1303               M         bcf STATUS, RP1
00F4   1283               M         bcf STATUS, RP0
00F5   00??           00220         movwf status_temp
                      00221         ; movf PCLATH, w ; save page information
                      00222         ; movwf pclath_temp
                      00223         ; clrf PCLATH
00F6   0804           00224         movf FSR, w ; save FSR
00F7   00??           00225         movwf FSR_temp
                      00226 
                      00227         ; Timer0 Interrupt Handle
                      00228         ; T0IE always on, no test
00F8   1D0B           00229         btfss INTCON, T0IF
00F9   2???           00230         goto int_tmr0_skip
00FA   0A??           00231         incf rt_counter, f
00FB   08??           00232         movf rt_counter, w ; test with 98h, correponds to 996,147.2us
00FC   3C98           00233         sublw 0x98
00FD   1D03           00234         btfss STATUS, Z
00FE   2???           00235         goto int_tmr0_end ; rt_counter <> 98h
00FF   01??           00236         clrf rt_counter ; rt_counter == 98h
0100   3045           00237         movlw rt_sec
0101   2???           00238         call addsec
0102   3042           00239         movlw rt_day
0103   1803           00240         btfsc STATUS, C
0104   2???           00241         call addday ; addday if carry from addsec
                      00242         MOVLF newsec, TRUE
0105   30FF               M         movlw 0xFF
0106   00EC               M         movwf newsec
0107                  00243 int_tmr0_end
0107   110B           00244         bcf INTCON, T0IF
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0108                  00245 int_tmr0_skip
                      00246         ; Keypad (PORTB) Change Interrupt
0108   1D8B           00247         btfss INTCON, RBIE ; interrept must be enabled first
0109   2???           00248         goto int_rb_skip
010A   1C0B           00249         btfss INTCON, RBIF
010B   2???           00250         goto int_rb_skip
010C   0E06           00251         swapf PORTB, w ; test PORTB<7:4> against stop button
010D   390F           00252         andlw 0x0F
010E   3C0B           00253         sublw STOP_BUT
010F   1D03           00254         btfss STATUS, Z
0110   2???           00255         goto int_rb_end
                      00256         ; Emergency Stop!!!!
0111   1107           00257         bcf IRLED ; turn off IRLEDs
0112   1007           00258         bcf VMOTOR_C0 ; turn off v motor
0113   1087           00259         bcf VMOTOR_C1
0114   1109           00260         bcf SMOTOR_EN ; turn off s motor
                      00261         MOVLF FSR, LCDline ; display emergency stop
0115   3023               M         movlw LCDline
0116   0084               M         movwf FSR
                      00262         COPY_STRING str_emerstop
0117   30??               M         movlw str_emerstop
0118   2???               M         call copystring
0119   2???           00263         call LCD_clear ; clear LCD display
011A   2???           00264         call writeline
011B   2???           00265         call LCD_out
Warning[207]: Found label after column 1. (stop)
011C   2???           00266         stop goto stop ; hang the program
011D                  00267 int_rb_end
011D   100B           00268         bcf INTCON, RBIF
011E                  00269 int_rb_skip
011E   08??           00270         movf FSR_temp, w ; restore FSR
011F   0084           00271         movwf FSR
                      00272         ; movf pclath_temp, w ; restore page information
                      00273         ; movwf PCLATH
0120   0E??           00274         swapf status_temp, w ; restore STATUS
0121   0083           00275         movwf STATUS
0122   0E??           00276         swapf w_temp, f ; restore W, not affecting STATUS
0123   0E??           00277         swapf w_temp, w
Warning[203]: Found opcode in column 1. (retfie)
0124   0009           00278 retfie
                      00279 
0125                  00280 init
0125   2???           00281         call init_pic
0126   2???           00282         call reset_software
                      00283         ;call reset_hardware
0127   2???           00284         call reset_realtime
0128   0181           00285         clrf TMR0 ; start timing
0129   168B           00286         bsf INTCON, T0IE
012A   178B           00287         bsf INTCON, GIE
012B   3002           00288         movlw PHASE_REALTIME
012C   00A0           00289         movwf phase
012D   2???           00290         call display
012E   0008           00291         return
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00292 
012F                  00293 init_pic
                      00294 ; Interrupt Initialization
                      00295 ; Disable Global interrupt, diable peripheral interrupt, enable timer0 and
                      00296 ; PORTB interrupton change (keypad), diable RB0 interrupt
                      00297 ; #define INITVAL_INTCON B'00101000'
                      00298 ; movlw INITVAL_INTCON
Warning[203]: Found opcode in column 1. (clrf)
012F   018B           00299 clrf INTCON
                      00300 ;
                      00301 ;clrf SSPBUF
                      00302 ;BANK1
                      00303 ;clrf TXSTA
                      00304 ;clrf PIE1
                      00305 ;clrf PIE2
                      00306 ; Timer0 Initialization
                      00307         BANK0
0130   1283               M         bcf STATUS, RP0
0131   0181           00308         clrf TMR0
0132   01??           00309         clrf rt_counter
                      00310         BANK1
0133   1683               M         bsf STATUS, RP0
0134   3085           00311         movlw INITVAL_OPTREG
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0135   0081           00312         movwf OPTION_REG
                      00313         ; PORT Initialzation
                      00314         ; BANK1
0136   302F           00315         movlw INITVAL_TRISA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0137   0085           00316         movwf TRISA
0138   30F2           00317         movlw INITVAL_TRISB
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0139   0086           00318         movwf TRISB
013A   30A0           00319         movlw INITVAL_TRISC
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
013B   0087           00320         movwf TRISC
013C   3000           00321         movlw INITVAL_TRISD
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
013D   0088           00322         movwf TRISD
013E   3000           00323         movlw INITVAL_TRISE
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
013F   0089           00324         movwf TRISE
                      00325 
                      00326         ; Analog to Digital Convertor Initialization
                      00327         ; BANK1
0140   3002           00328         movlw INITVAL_ADCON1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0141   009F           00329         movwf ADCON1
                      00330         BANK0
0142   1283               M         bcf STATUS, RP0
0143   3081           00331         movlw INITVAL_ADCON0
0144   009F           00332         movwf ADCON0
0145   0008           00333         return
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00334 
                      00335 ;*******************************************************************************
                      00336 ;"reset_software": Software Reset/Initialization Function
                      00337 ; Func: Reset all variables
                      00338 ; Input: None
                      00339 ; Output: phase, report_num, line_num, log_total, log_next, smotor_dir
                      00340 ; Affect: STATUS
                      00341 ;*******************************************************************************
0146                  00342 reset_software
0146   3000           00343         movlw PHASE_HDINIT
0147   00A0           00344         movwf phase
0148   01A1           00345         clrf report_num
0149   01A2           00346         clrf line_num
014A   01E8           00347         clrf log_total
014B   01E9           00348         clrf log_next
                      00349         MOVLF smotor_dir, 1
014C   3001               M         movlw 1
014D   00E7               M         movwf smotor_dir
014E   0008           00350         return
                      00351 
                      00352 ;*******************************************************************************
                      00353 ;"reset_hardware": Hardware Reset/Initialization Function
                      00354 ; Func: Reset/Initialize hardwares to their default position:
                      00355 ; Pos Sensor Off, V DC Motor at top, S Motor at "Row 1",
                      00356 ; LCD, (RTC)
                      00357 ; Input: None
                      00358 ; Output: PORTA, PORTB, PORTC, PORTD, PORTE
                      00359 ; Affect: W, STATUS, temp, delaytemp, delaycount, delaytemp2,
                      00360 ; delaycount2, delaytemp3, delaycount3
                      00361 ;*******************************************************************************
014F                  00362 reset_hardware
                      00363         ; PORT Reset/Initialization
                      00364         ; BANK0
014F   0185           00365         clrf PORTA ; RA4 (Reserved) output 0
0150   0186           00366         clrf PORTB ; RB0, 2, 3 (Reserved) output 0
0151   0187           00367         clrf PORTC ; VMOTOR disable, LED off
0152   0188           00368         clrf PORTD ; clear S0, S1 of SMOTOR
0153   0189           00369         clrf PORTE ; SMOTOR disable, clear S2, S3 of SMOTOR
                      00370         ; LCD Reset/Initialization
0154   2???           00371         call LCD_init
0155   2???           00372         call display
                      00373         ; Position Sensor(IRLED) Reset/Initialization: all off
                      00374         ; Already done with PORT reset
                      00375         ; Vertical DC Motor Reset/Initialization: move to top
0156   2???           00376         call moveup
                      00377         ; Stepper Motor Reset/Initialization: move to "Row 4"
0157   01E7           00378         clrf smotor_dir
0158   2???           00379         call advancerow ; 4 advance row to ensure to init pos
0159   2???           00380         call advancerow
015A   2???           00381         call advancerow
015B   2???           00382         call advancerow
                      00383         MOVLF smotor_dir, 1
015C   3001               M         movlw 1
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

015D   00E7               M         movwf smotor_dir
015E   0008           00384         return
                      00385 
                      00386 ;*******************************************************************************
                      00387 ;"reset_realtime": Real Time Clock Reset/Initialization Function
                      00388 ; Func: Reset Real Time Clock
                      00389 ; Input: None (from Keypad)
                      00390 ; Output: rt_year, rt_month, rt_day, rt_hour, rt_min, rt_sec
                      00391 ; Affect:
                      00392 ;*******************************************************************************
015F                  00393 reset_realtime
015F   3001           00394         movlw PHASE_RTCINIT
0160   00A0           00395         movwf phase
0161   01C0           00396         clrf rt_year
0162   01C1           00397         clrf rt_month
0163   01C2           00398         clrf rt_day
0164   01C3           00399         clrf rt_hour
0165   01C4           00400         clrf rt_min
0166   01C5           00401         clrf rt_sec
                      00402         ; YYMMDD
0167   2???           00403         call LCD_clear ; clear LCD display
                      00404         MOVLF FSR, LCDline
0168   3023               M         movlw LCDline
0169   0084               M         movwf FSR
                      00405         COPY_STRING str_enterymd
016A   30??               M         movlw str_enterymd
016B   2???               M         call copystring
016C   2???           00406         call writeline
016D   2???           00407         call LCD_line2
                      00408         MOVLF FSR, LCDline
016E   3023               M         movlw LCDline
016F   0084               M         movwf FSR
                      00409         COPY_STRING str_yearhead
0170   30??               M         movlw str_yearhead
0171   2???               M         call copystring
0172   2???           00410         call writeline
0173   01B6           00411         clrf temp3 ; number of valid numbers entered
0174                  00412 reset_rt_ymd
0174   1C86           00413         btfss KEYPAD_DA ; Wait until data is available from the keypad
0175   2???           00414         goto reset_rt_ymd
0176   0E06           00415         swapf PORTB, W ; Read PortB<7:4> into W<3:0>
0177   390F           00416         andlw 0x0F
0178   3E??           00417         addlw char_keynumber
0179   2???           00418         call literal ; Convert keypad value to LCD character (value is still held in W)
017A   3E00           00419         addlw 0x00
017B   1903           00420         btfsc STATUS, Z ; test for valid input (number)
017C   2???           00421         goto reset_rt_ymdrl
017D   00B5           00422         movwf temp2 ; hold the value
017E   2???           00423         call LCD_wt ; Write the value in W to LCD
017F   3030           00424         movlw 0x30
0180   02B5           00425         subwf temp2, f ; convert ASCII to number
0181   0836           00426         movf temp3, w
                      00427         TABLE ; switch (temp)
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000                    M         local tablename
0182   00??               M         movwf table_temp
0183   30??               M         movlw HIGH tablename
0184   008A               M         movwf PCLATH
0185   08??               M         movf table_temp, w
0186   3E??               M         addlw LOW tablename
0187   1803               M         btfsc STATUS, C
0188   0A8A               M         incf PCLATH, f
0189   0082               M         movwf PCL
Warning[207]: Found label after column 1. (tablename)
018A                      M         tablename
018A   2???           00428         goto reset_rt_ymd0
018B   2???           00429         goto reset_rt_ymd1
018C   2???           00430         goto reset_rt_ymd2
018D   2???           00431         goto reset_rt_ymd3
018E   2???           00432         goto reset_rt_ymd4
018F   2???           00433         goto reset_rt_ymd5
0190                  00434 reset_rt_ymd0
0190   0835           00435         movf temp2, w
                      00436         MULLW .10
0191   00EA               M         movwf arith_temp
0192   300A               M         movlw .10
0193   2???               M         call mulfn
0194   07C0           00437         addwf rt_year, f
0195   0AB6           00438         incf temp3, f
0196   2???           00439         goto reset_rt_ymdrl
0197                  00440 reset_rt_ymd1
0197   0835           00441         movf temp2, w
0198   07C0           00442         addwf rt_year, f
0199   0AB6           00443         incf temp3, f
019A   2???           00444         goto reset_rt_ymdrl
019B                  00445 reset_rt_ymd2
019B   0835           00446         movf temp2, w
                      00447         MULLW .10
019C   00EA               M         movwf arith_temp
019D   300A               M         movlw .10
019E   2???               M         call mulfn
019F   07C1           00448         addwf rt_month, f
01A0   0AB6           00449         incf temp3, f
01A1   2???           00450         goto reset_rt_ymdrl
01A2                  00451 reset_rt_ymd3
01A2   0835           00452         movf temp2, w
01A3   07C1           00453         addwf rt_month, f
01A4   0AB6           00454         incf temp3, f
01A5   2???           00455         goto reset_rt_ymdrl
01A6                  00456 reset_rt_ymd4
01A6   0835           00457         movf temp2, w
                      00458         MULLW .10
01A7   00EA               M         movwf arith_temp
01A8   300A               M         movlw .10
01A9   2???               M         call mulfn
01AA   07C2           00459         addwf rt_day, f
01AB   0AB6           00460         incf temp3, f
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01AC   2???           00461         goto reset_rt_ymdrl
01AD                  00462 reset_rt_ymd5
01AD   0835           00463         movf temp2, w
01AE   07C2           00464         addwf rt_day, f
01AF   0AB6           00465         incf temp3, f
01B0                  00466 reset_rt_ymdrl
01B0   1886           00467         btfsc KEYPAD_DA ; Wait until key is released
01B1   2???           00468         goto reset_rt_ymdrl
01B2   3006           00469         movlw 0x06 ; 6 chars entered
01B3   0236           00470         subwf temp3, w
01B4   1C03           00471         btfss STATUS, C
01B5   2???           00472         goto reset_rt_ymd
                      00473         ; hhmmss
01B6   2???           00474         call LCD_clear ; clear LCD display
                      00475         MOVLF FSR, LCDline
01B7   3023               M         movlw LCDline
01B8   0084               M         movwf FSR
                      00476         COPY_STRING str_enterhms
01B9   30??               M         movlw str_enterhms
01BA   2???               M         call copystring
01BB   2???           00477         call writeline
01BC   2???           00478         call LCD_line2
01BD   01B6           00479         clrf temp3 ; number of valid numbers entered
01BE                  00480 reset_rt_hms
01BE   1C86           00481         btfss KEYPAD_DA ; Wait until data is available from the keypad
01BF   2???           00482         goto reset_rt_hms
01C0   0E06           00483         swapf PORTB, W ; Read PortB<7:4> into W<3:0>
01C1   390F           00484         andlw 0x0F
01C2   3E??           00485         addlw char_keynumber
01C3   2???           00486         call literal ; Convert keypad value to LCD character (value is still held in W)
01C4   3E00           00487         addlw 0x00
01C5   1903           00488         btfsc STATUS, Z ; test for valid input (number)
01C6   2???           00489         goto reset_rt_hmsrl
01C7   00B5           00490         movwf temp2 ; hold the value
01C8   2???           00491         call LCD_wt ; Write the value in W to LCD
01C9   3030           00492         movlw 0x30
01CA   02B5           00493         subwf temp2, f ; convert ASCII to number
01CB   0836           00494         movf temp3, w
                      00495         TABLE ; switch (temp)
  0000                    M         local tablename
01CC   00??               M         movwf table_temp
01CD   30??               M         movlw HIGH tablename
01CE   008A               M         movwf PCLATH
01CF   08??               M         movf table_temp, w
01D0   3E??               M         addlw LOW tablename
01D1   1803               M         btfsc STATUS, C
01D2   0A8A               M         incf PCLATH, f
01D3   0082               M         movwf PCL
Warning[207]: Found label after column 1. (tablename)
01D4                      M         tablename
01D4   2???           00496         goto reset_rt_hms0
01D5   2???           00497         goto reset_rt_hms1
01D6   2???           00498         goto reset_rt_hms2
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01D7   2???           00499         goto reset_rt_hms3
01D8   2???           00500         goto reset_rt_hms4
01D9   2???           00501         goto reset_rt_hms5
01DA                  00502 reset_rt_hms0
01DA   0835           00503         movf temp2, w
                      00504         MULLW .10
01DB   00EA               M         movwf arith_temp
01DC   300A               M         movlw .10
01DD   2???               M         call mulfn
01DE   07C3           00505         addwf rt_hour, f
01DF   0AB6           00506         incf temp3, f
01E0   2???           00507         goto reset_rt_hmsrl
01E1                  00508 reset_rt_hms1
01E1   0835           00509         movf temp2, w
01E2   07C3           00510         addwf rt_hour, f
01E3   0AB6           00511         incf temp3, f
01E4   2???           00512         goto reset_rt_hmsrl
01E5                  00513 reset_rt_hms2
01E5   0835           00514         movf temp2, w
                      00515         MULLW .10
01E6   00EA               M         movwf arith_temp
01E7   300A               M         movlw .10
01E8   2???               M         call mulfn
01E9   07C4           00516         addwf rt_min, f
01EA   0AB6           00517         incf temp3, f
01EB   2???           00518         goto reset_rt_hmsrl
01EC                  00519 reset_rt_hms3
01EC   0835           00520         movf temp2, w
01ED   07C4           00521         addwf rt_min, f
01EE   0AB6           00522         incf temp3, f
01EF   2???           00523         goto reset_rt_hmsrl
01F0                  00524 reset_rt_hms4
01F0   0835           00525         movf temp2, w
                      00526         MULLW .10
01F1   00EA               M         movwf arith_temp
01F2   300A               M         movlw .10
01F3   2???               M         call mulfn
01F4   07C5           00527         addwf rt_sec, f
01F5   0AB6           00528         incf temp3, f
01F6   2???           00529         goto reset_rt_hmsrl
Warning[207]: Found label after column 1. (reset_rt_hms5)
01F7                  00530         reset_rt_hms5
01F7   0835           00531         movf temp2, w
01F8   07C5           00532         addwf rt_sec, f
01F9   0AB6           00533         incf temp3, f
Warning[207]: Found label after column 1. (reset_rt_hmsrl)
01FA                  00534         reset_rt_hmsrl
01FA   1886           00535         btfsc KEYPAD_DA ; Wait until key is released
01FB   2???           00536         goto reset_rt_hmsrl
01FC   3006           00537         movlw 0x06 ; 6 chars entered
01FD   0236           00538         subwf temp3, w
01FE   1C03           00539         btfss STATUS, C
01FF   2???           00540         goto reset_rt_hms
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0200   0008           00541         return
                      00542 
                      00543 ;*******************************************************************************
                      00544 ; "keyresp": Key Response Function
                      00545 ; Func: Display information or run an inspection according to the
                      00546 ; pressed key
                      00547 ; Input: W: Index of the key that being pressed
                      00548 ; Output: All actions
                      00549 ; Affect:
                      00550 ;*******************************************************************************
0201                  00551 keyresp
0201   0E06           00552         swapf PORTB, w
0202   390F           00553         andlw 0x0F
                      00554         TABLE
  0000                    M         local tablename
0203   00??               M         movwf table_temp
0204   30??               M         movlw HIGH tablename
0205   008A               M         movwf PCLATH
0206   08??               M         movf table_temp, w
0207   3E??               M         addlw LOW tablename
0208   1803               M         btfsc STATUS, C
0209   0A8A               M         incf PCLATH, f
020A   0082               M         movwf PCL
Warning[207]: Found label after column 1. (tablename)
020B                      M         tablename
                      00555 ;keyresp_switch_table
020B   2???           00556         goto realtime ; keypressed = 0 "1" = "real time"
020C   2???           00557         goto report ; keypressed = 1 "2" = "report"
020D   2???           00558         goto unused_key ; keypressed = 2 "3"
020E   2???           00559         goto unused_key ; keypressed = 3 "A"
020F   2???           00560         goto unused_key ; keypressed = 4 "4"
0210   2???           00561         goto unused_key ; keypressed = 5 "5"
0211   2???           00562         goto unused_key ; keypressed = 6 "6"
0212   2???           00563         goto unused_key ; keypressed = 7 "B"
0213   2???           00564         goto scroll_up ; keypressed = 8 "7" = "scroll up"
0214   2???           00565         goto report_last ; keypressed = 9 "8" = "report last"
0215   2???           00566         goto unused_key ; keypressed = A "9"
0216   2???           00567         goto stoprun ; keypressed = B "C" = "stop"
0217   2???           00568         goto scroll_down ; keypressed = C "*" = "scroll down"
0218   2???           00569         goto report_next ; keypressed = D "0" = "scroll up"
0219   2???           00570         goto unused_key ; keypressed = E "#"
021A   2???           00571         goto startrun ; keypressed = F "D" = "run"
021B                  00572 unused_key
021B                  00573 keyresp_next
021B                  00574 wait_release
021B   1886           00575         btfsc KEYPAD_DA ; Wait until key is released????
021C   2???           00576         goto wait_release ; !!!!!!!!!!time
021D   2???           00577         call display
                      00578         ; reset timeout!!!!!!!!!!
021E   0008           00579         return
                      00580 
021F                  00581 realtime
021F   3002           00582         movlw PHASE_REALTIME
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0220   00A0           00583         movwf phase
0221   01A2           00584         clrf line_num
0222   2???           00585         goto keyresp_next
0223                  00586 report
0223   3004           00587         movlw PHASE_REPORT ; assuem log_total <> 0
0224   08E8           00588         movf log_total, f
0225   1903           00589         btfsc STATUS, Z
0226   3003           00590         movlw PHASE_NOREPORT ; log_total == 0, no report
0227   00A0           00591         movwf phase
0228   01A2           00592         clrf line_num
0229   2???           00593         goto keyresp_next
022A                  00594 report_last
                      00595 ; !!!! some ideas: must in REPORT phase; no change in line_num if at last report;
                      00596 ; do not go through report; if enter from other phase same fn to report;
                      00597 ; display report# and can go across upper/lower limit
022A   08E8           00598         movf log_total, f
022B   1903           00599         btfsc STATUS, Z
022C   2???           00600         goto report ; log_total == 0, no report!!!!
                      00601         ; lower bound = (log_next - log_total + MAXLOG) MOD MAXLOG
022D   0868           00602         movf log_total, w ; get lower bound
022E   0269           00603         subwf log_next, w
022F   3E0C           00604         addlw MAXLOG
                      00605         MODLW MAXLOG
0230   00EA               M         movwf arith_temp
0231   300C               M         movlw MAXLOG
0232   2???               M         call divfn
0233   086A               M         movf arith_temp, w
0234   0221           00606         subwf report_num, w
0235   1903           00607         btfsc STATUS, Z
0236   2???           00608         goto report ; current report at lower bound!!!!"This is the last report"!!!!
0237   0321           00609         decf report_num, w ; get last report
0238   3E0C           00610         addlw MAXLOG ; make sure report_num between 0 and MAXLOG - 1
                      00611         MODLW MAXLOG
0239   00EA               M         movwf arith_temp
023A   300C               M         movlw MAXLOG
023B   2???               M         call divfn
023C   086A               M         movf arith_temp, w
023D   00A1           00612         movwf report_num
023E   2???           00613         call readlog
023F   2???           00614         goto report
0240                  00615 report_next
0240   08E8           00616         movf log_total, f
0241   1903           00617         btfsc STATUS, Z
0242   2???           00618         goto report ; log_total == 0, no report!!!!
                      00619         ; upper bound = (log_next - 1 + MAXLOG) MOD MAXLOG
0243   0369           00620         decf log_next, w ; get upper bound
0244   3E0C           00621         addlw MAXLOG
                      00622         MODLW MAXLOG
0245   00EA               M         movwf arith_temp
0246   300C               M         movlw MAXLOG
0247   2???               M         call divfn
0248   086A               M         movf arith_temp, w
0249   0221           00623         subwf report_num, w
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

024A   1903           00624         btfsc STATUS, Z
024B   2???           00625         goto report ; current report at upper bound!!!!
024C   0A21           00626         incf report_num, w ; get next report
                      00627         MODLW MAXLOG ; make sure report_num between 0 and MAXLOG - 1
024D   00EA               M         movwf arith_temp
024E   300C               M         movlw MAXLOG
024F   2???               M         call divfn
0250   086A               M         movf arith_temp, w
0251   00A1           00628         movwf report_num
0252   2???           00629         call readlog
0253   2???           00630         goto report
0254                  00631 scroll_up
0254   3004           00632         movlw PHASE_REPORT ; test phase == PHASE_REPORT
0255   0220           00633         subwf phase, w
0256   1D03           00634         btfss STATUS, Z
0257   2???           00635         goto keyresp_next ; phase <> PHASE_REPORT, do nothing
0258   08A2           00636         movf line_num, f ; phase == PHASE_REPORT, test line_num == 0
0259   1D03           00637         btfss STATUS, Z
025A   03A2           00638         decf line_num, f ; line_num <> 0, decrease line_num (scroll up)
025B   2???           00639         goto keyresp_next
025C                  00640 scroll_down
025C   3004           00641         movlw PHASE_REPORT ; test phase == PHASE_REPORT
025D   0220           00642         subwf phase, w
025E   1D03           00643         btfss STATUS, Z
025F   2???           00644         goto keyresp_next ; phase <> PHASE_REPORT, do nothing
0260   3009           00645         movlw MAXLINE ; phase == PHASE_REPORT, test line_num == MAXLINE????
0261   0222           00646         subwf line_num, w
0262   1D03           00647         btfss STATUS, Z
0263   0AA2           00648         incf line_num, f ; line_num <> MAXLINE, increase line_num (scroll down)
0264   2???           00649         goto keyresp_next
0265                  00650 startrun
0265   3005           00651         movlw PHASE_RUN
0266   00A0           00652         movwf phase
0267   01A2           00653         clrf line_num
                      00654         ;!!!! call display
0268   2???           00655         call LCD_clear ; clear LCD display
                      00656         MOVLF FSR, LCDline
0269   3023               M         movlw LCDline
026A   0084               M         movwf FSR
                      00657         COPY_STRING str_running
026B   30??               M         movlw str_running
026C   2???               M         call copystring
026D   2???           00658         call writeline
026E   2???           00659         call run
                      00660         MOVLF phase, PHASE_FINISH
026F   3006               M         movlw 6
0270   00A0               M         movwf phase
0271   01A2           00661         clrf line_num
0272   2???           00662         call display
                      00663         ; call delay1sl
                      00664         MOVLF phase, PHASE_REPORT
0273   3004               M         movlw 4
0274   00A0               M         movwf phase
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0275   01A2           00665         clrf line_num
0276   2???           00666         call display
                      00667         ; assume run time is very long, key has been released
0277   0008           00668         return
0278                  00669 stoprun
0278   2???           00670         goto keyresp_next
                      00671 
                      00672 ;*******************************************************************************
                      00673 ;"keypad_timeout":
                      00674 ; Func:
                      00675 ; Input:
                      00676 ; Output:
                      00677 ; Affect:
                      00678 ;*******************************************************************************
0279                  00679 keypad_timeout
0279   08EC           00680         movf newsec, f
027A   1903           00681         btfsc STATUS, Z
027B   2???           00682         goto kp_to_nonewsec ; newsec == 0(FALSE), skip
027C   2???           00683         call display ; newsec == TRUE, display the new sec
027D   01EC           00684         clrf newsec
027E                  00685 kp_to_nonewsec
                      00686 ; SLEEP test goes here!!!!
027E   0008           00687         return
                      00688 
                      00689 ;*******************************************************************************
                      00690 ; "display": Display Function (User Interface)
                      00691 ; Func: First make up the content to be displayed into LCDline
                      00692 ; according to phase and line_num, then print the string
                      00693 ; to the LCD
                      00694 ; Input: phase, line_num
                      00695 ; Output: None (to LCD)
                      00696 ; Affect: W, STATUS, FSR, temp2, table_temp, arg, arg2,
                      00697 ; delaytemp, delaycount, lcd_temp
                      00698 ;*******************************************************************************
027F                  00699 display
                      00700 ; run phase does not use general display function
027F   0820           00701         movf phase, w
0280   3C05           00702         sublw PHASE_RUN
0281   1903           00703         btfsc STATUS, Z
0282   0008           00704         return
0283   0822           00705         movf line_num, w ; current line#
0284   2???           00706         call makeline
0285   2???           00707         call LCD_clear ; clear LCD display
0286   2???           00708         call writeline
0287   0A22           00709         incf line_num, w ; next line# in W, but not inc line#
0288   2???           00710         call makeline
0289   2???           00711         call LCD_line2
028A   2???           00712         call writeline
028B   2???           00713         call LCD_out ; move the cursor out of screen
028C   0008           00714         return
                      00715 ;*******************************************************************************
                      00716 ; "makeline": Displayable Line Make & Copy Function
                      00717 ; Func: Make lines to be displayed according to the phase and
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00718 ; line number (W), copy it to the LCDline array
                      00719 ; Input: W = line # to be displayed, phase
                      00720 ; Output: FSR = point to the null termination of the line made &
                      00721 ; copied, (Copied line in LCDline)
                      00722 ; Affect: W, STATUS, temp2, temp3, table_temp, arg, arg2, literal_addr
                      00723 ;*******************************************************************************
028D                  00724 makeline
028D   00B5           00725         movwf temp2 ; line#
                      00726         MOVLF FSR, LCDline ; start from LCDline
028E   3023               M         movlw LCDline
028F   0084               M         movwf FSR
0290   0820           00727         movf phase, w
                      00728         TABLE ; switch (phase)
  0000                    M         local tablename
0291   00??               M         movwf table_temp
0292   30??               M         movlw HIGH tablename
0293   008A               M         movwf PCLATH
0294   08??               M         movf table_temp, w
0295   3E??               M         addlw LOW tablename
0296   1803               M         btfsc STATUS, C
0297   0A8A               M         incf PCLATH, f
0298   0082               M         movwf PCL
Warning[207]: Found label after column 1. (tablename)
0299                      M         tablename
0299   2???           00729         goto ML_hdinit ; phase == 0
029A   2???           00730         goto ML_rtcinit ; phase == 1
029B   2???           00731         goto ML_realtime ; phase == 2
029C   2???           00732         goto ML_noreport ; phase == 3
029D   2???           00733         goto ML_report ; phase == 4
029E   2???           00734         goto ML_run ; phase == 5
029F   2???           00735         goto ML_finish ; phase == 6
02A0                  00736 ML_hdinit
02A0   0835           00737         movf temp2, w
                      00738         TABLE ; switch (temp2(line#))
  0000                    M         local tablename
02A1   00??               M         movwf table_temp
02A2   30??               M         movlw HIGH tablename
02A3   008A               M         movwf PCLATH
02A4   08??               M         movf table_temp, w
02A5   3E??               M         addlw LOW tablename
02A6   1803               M         btfsc STATUS, C
02A7   0A8A               M         incf PCLATH, f
02A8   0082               M         movwf PCL
Warning[207]: Found label after column 1. (tablename)
02A9                      M         tablename
02A9   2???           00739         goto ML_hdinit_0 ; line# == 0
02AA   2???           00740         goto ML_hdinit_1 ; line# == 1
02AB                  00741 ML_rtcinit ; display do not use this function
                      00742         COPY_STRING str_null ; null termination
02AB   30??               M         movlw str_null
02AC   2???               M         call copystring
02AD   0008           00743         return
02AE                  00744 ML_realtime
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02AE   0835           00745         movf temp2, w
                      00746         TABLE ; switch (temp2(line#))
  0000                    M         local tablename
02AF   00??               M         movwf table_temp
02B0   30??               M         movlw HIGH tablename
02B1   008A               M         movwf PCLATH
02B2   08??               M         movf table_temp, w
02B3   3E??               M         addlw LOW tablename
02B4   1803               M         btfsc STATUS, C
02B5   0A8A               M         incf PCLATH, f
02B6   0082               M         movwf PCL
Warning[207]: Found label after column 1. (tablename)
02B7                      M         tablename
02B7   2???           00747         goto ML_realtime_0 ; line# == 0
02B8   2???           00748         goto ML_realtime_1 ; line# == 1
02B9                  00749 ML_noreport
02B9   0835           00750         movf temp2, w
                      00751         TABLE ; switch (temp2(line#))
  0000                    M         local tablename
02BA   00??               M         movwf table_temp
02BB   30??               M         movlw HIGH tablename
02BC   008A               M         movwf PCLATH
02BD   08??               M         movf table_temp, w
02BE   3E??               M         addlw LOW tablename
02BF   1803               M         btfsc STATUS, C
02C0   0A8A               M         incf PCLATH, f
02C1   0082               M         movwf PCL
Warning[207]: Found label after column 1. (tablename)
02C2                      M         tablename
02C2   2???           00752         goto ML_noreport_0 ; line# == 0
02C3   2???           00753         goto ML_noreport_1 ; line# == 1
02C4                  00754 ML_report
02C4   0835           00755         movf temp2, w
                      00756         TABLE ; switch (temp2(line#))
  0000                    M         local tablename
02C5   00??               M         movwf table_temp
02C6   30??               M         movlw HIGH tablename
02C7   008A               M         movwf PCLATH
02C8   08??               M         movf table_temp, w
02C9   3E??               M         addlw LOW tablename
02CA   1803               M         btfsc STATUS, C
02CB   0A8A               M         incf PCLATH, f
02CC   0082               M         movwf PCL
Warning[207]: Found label after column 1. (tablename)
02CD                      M         tablename
02CD   2???           00757         goto ML_report_0 ; line# == 0
02CE   2???           00758         goto ML_report_1 ; line# == 1
02CF   2???           00759         goto ML_report_2 ; line# == 2
02D0   2???           00760         goto ML_report_3 ; line# == 3
02D1   2???           00761         goto ML_report_4 ; line# == 4
02D2   2???           00762         goto ML_report_5 ; line# == 5
02D3   2???           00763         goto ML_report_6 ; line# == 6
02D4   2???           00764         goto ML_report_7 ; line# == 7
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02D5   2???           00765         goto ML_report_8 ; line# == 8
02D6   2???           00766         goto ML_report_9 ; line# == 9
02D7   2???           00767         goto ML_report_10 ; line# == 10
02D8                  00768 ML_run
02D8   0835           00769         movf temp2, w
                      00770         TABLE ; switch (temp2(line#))
  0000                    M         local tablename
02D9   00??               M         movwf table_temp
02DA   30??               M         movlw HIGH tablename
02DB   008A               M         movwf PCLATH
02DC   08??               M         movf table_temp, w
02DD   3E??               M         addlw LOW tablename
02DE   1803               M         btfsc STATUS, C
02DF   0A8A               M         incf PCLATH, f
02E0   0082               M         movwf PCL
Warning[207]: Found label after column 1. (tablename)
02E1                      M         tablename
02E1   2???           00771         goto ML_run_0 ; line# == 0
02E2   2???           00772         goto ML_run_1 ; line# == 1
02E3                  00773 ML_finish
02E3   0835           00774         movf temp2, w
                      00775         TABLE ; switch (temp2(line#))
  0000                    M         local tablename
02E4   00??               M         movwf table_temp
02E5   30??               M         movlw HIGH tablename
02E6   008A               M         movwf PCLATH
02E7   08??               M         movf table_temp, w
02E8   3E??               M         addlw LOW tablename
02E9   1803               M         btfsc STATUS, C
02EA   0A8A               M         incf PCLATH, f
02EB   0082               M         movwf PCL
Warning[207]: Found label after column 1. (tablename)
02EC                      M         tablename
02EC   2???           00776         goto ML_finish_0 ; line# == 0
02ED   2???           00777         goto ML_finish_1 ; line# == 1
02EE                  00778 ML_hdinit_0
                      00779         COPY_STRING str_init
02EE   30??               M         movlw str_init
02EF   2???               M         call copystring
02F0   0008           00780         return
02F1                  00781 ML_hdinit_1
                      00782         COPY_STRING str_null
02F1   30??               M         movlw str_null
02F2   2???               M         call copystring
02F3   0008           00783         return
02F4                  00784 ML_realtime_0
                      00785         COPY_STRING str_yearhead
02F4   30??               M         movlw str_yearhead
02F5   2???               M         call copystring
                      00786         COPY_DEC2 rt_year
02F6   0840               M         movf rt_year,   w
02F7   00BB               M         movwf arg
02F8   3002               M         movlw 0x02
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02F9   00BC               M         movwf arg2
02FA   2???               M         call copydec
                      00787         COPY_STRING str_dash
02FB   30??               M         movlw str_dash
02FC   2???               M         call copystring
                      00788         COPY_DEC2 rt_month
02FD   0841               M         movf rt_month,  w
02FE   00BB               M         movwf arg
02FF   3002               M         movlw 0x02
0300   00BC               M         movwf arg2
0301   2???               M         call copydec
                      00789         COPY_STRING str_dash
0302   30??               M         movlw str_dash
0303   2???               M         call copystring
                      00790         COPY_DEC2 rt_day
0304   0842               M         movf rt_day,    w
0305   00BB               M         movwf arg
0306   3002               M         movlw 0x02
0307   00BC               M         movwf arg2
0308   2???               M         call copydec
0309   0008           00791         return
030A                  00792 ML_realtime_1
                      00793         COPY_DEC2 rt_hour
030A   0843               M         movf rt_hour,   w
030B   00BB               M         movwf arg
030C   3002               M         movlw 0x02
030D   00BC               M         movwf arg2
030E   2???               M         call copydec
                      00794         COPY_STRING str_colon
030F   30??               M         movlw str_colon
0310   2???               M         call copystring
                      00795         COPY_DEC2 rt_min
0311   0844               M         movf rt_min,    w
0312   00BB               M         movwf arg
0313   3002               M         movlw 0x02
0314   00BC               M         movwf arg2
0315   2???               M         call copydec
                      00796         COPY_STRING str_colon
0316   30??               M         movlw str_colon
0317   2???               M         call copystring
                      00797         COPY_DEC2 rt_sec
0318   0845               M         movf rt_sec,    w
0319   00BB               M         movwf arg
031A   3002               M         movlw 0x02
031B   00BC               M         movwf arg2
031C   2???               M         call copydec
031D   0008           00798         return
031E                  00799 ML_noreport_0
                      00800         COPY_STRING str_noreport
031E   30??               M         movlw str_noreport
031F   2???               M         call copystring
0320   0008           00801         return
0321                  00802 ML_noreport_1
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00803         COPY_STRING str_null
0321   30??               M         movlw str_null
0322   2???               M         call copystring
0323   0008           00804         return
0324                  00805 ML_report_0
                      00806         COPY_STRING str_entry
0324   30??               M         movlw str_entry
0325   2???               M         call copystring
                      00807         ; log# = (log_total - log_next + report_num + 1 + MAXLOG) MOD MAXLOG
                      00808         ; also log# = MAXLOG if result == 0
0326   0869           00809         movf log_next, w
0327   0268           00810         subwf log_total, w
0328   0721           00811         addwf report_num, w
0329   3E01           00812         addlw 0x01
032A   3E0C           00813         addlw MAXLOG
                      00814         MODLW MAXLOG
032B   00EA               M         movwf arith_temp
032C   300C               M         movlw MAXLOG
032D   2???               M         call divfn
032E   086A               M         movf arith_temp, w
032F   1903           00815         btfsc STATUS, Z
0330   300C           00816         movlw MAXLOG ; result == 0, log# = MAXLOG
0331   00B6           00817         movwf temp3
                      00818         COPY_DEC2 temp3
0332   0836               M         movf temp3,     w
0333   00BB               M         movwf arg
0334   3002               M         movlw 0x02
0335   00BC               M         movwf arg2
0336   2???               M         call copydec
                      00819         COPY_STRING char_slash
0337   30??               M         movlw char_slash
0338   2???               M         call copystring
                      00820         COPY_DEC2 log_total
0339   0868               M         movf log_total, w
033A   00BB               M         movwf arg
033B   3002               M         movlw 0x02
033C   00BC               M         movwf arg2
033D   2???               M         call copydec
033E   0008           00821         return
033F                  00822 ML_report_1
                      00823         COPY_STRING str_start
033F   30??               M         movlw str_start
0340   2???               M         call copystring
                      00824         COPY_DEC2 st_hour
0341   0849               M         movf st_hour,   w
0342   00BB               M         movwf arg
0343   3002               M         movlw 0x02
0344   00BC               M         movwf arg2
0345   2???               M         call copydec
                      00825         COPY_STRING str_colon
0346   30??               M         movlw str_colon
0347   2???               M         call copystring
                      00826         COPY_DEC2 st_min
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0348   084A               M         movf st_min,    w
0349   00BB               M         movwf arg
034A   3002               M         movlw 0x02
034B   00BC               M         movwf arg2
034C   2???               M         call copydec
                      00827         COPY_STRING str_colon
034D   30??               M         movlw str_colon
034E   2???               M         call copystring
                      00828         COPY_DEC2 st_sec
034F   084B               M         movf st_sec,    w
0350   00BB               M         movwf arg
0351   3002               M         movlw 0x02
0352   00BC               M         movwf arg2
0353   2???               M         call copydec
0354   0008           00829         return
0355                  00830 ML_report_2
                      00831         COPY_STRING str_finish
0355   30??               M         movlw str_finish
0356   2???               M         call copystring
                      00832         COPY_DEC2 end_hour
0357   084C               M         movf end_hour,  w
0358   00BB               M         movwf arg
0359   3002               M         movlw 0x02
035A   00BC               M         movwf arg2
035B   2???               M         call copydec
                      00833         COPY_STRING str_colon
035C   30??               M         movlw str_colon
035D   2???               M         call copystring
                      00834         COPY_DEC2 end_min
035E   084D               M         movf end_min,   w
035F   00BB               M         movwf arg
0360   3002               M         movlw 0x02
0361   00BC               M         movwf arg2
0362   2???               M         call copydec
                      00835         COPY_STRING str_colon
0363   30??               M         movlw str_colon
0364   2???               M         call copystring
                      00836         COPY_DEC2 end_sec
0365   084E               M         movf end_sec,   w
0366   00BB               M         movwf arg
0367   3002               M         movlw 0x02
0368   00BC               M         movwf arg2
0369   2???               M         call copydec
036A   0008           00837         return
036B                  00838 ML_report_3
                      00839         COPY_STRING str_runtime
036B   30??               M         movlw str_runtime
036C   2???               M         call copystring
                      00840         COPY_DEC1 runtime
036D   084F               M         movf runtime,   w
036E   00BB               M         movwf arg
036F   3001               M         movlw 0x01
0370   00BC               M         movwf arg2
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0371   2???               M         call copydec
                      00841         COPY_STRING str_s
0372   30??               M         movlw str_s
0373   2???               M         call copystring
0374   0008           00842         return
0375                  00843 ML_report_4
                      00844         COPY_STRING str_total
0375   30??               M         movlw str_total
0376   2???               M         call copystring
                      00845         COPY_DEC1 cl_total
0377   0850               M         movf cl_total,  w
0378   00BB               M         movwf arg
0379   3001               M         movlw 0x01
037A   00BC               M         movwf arg2
037B   2???               M         call copydec
037C   0008           00846         return
037D                  00847 ML_report_5
                      00848         COPY_STRING str_pass
037D   30??               M         movlw str_pass
037E   2???               M         call copystring
                      00849         COPY_DEC1 cl_pass
037F   0851               M         movf cl_pass,   w
0380   00BB               M         movwf arg
0381   3001               M         movlw 0x01
0382   00BC               M         movwf arg2
0383   2???               M         call copydec
                      00850         COPY_STRING str_fail
0384   30??               M         movlw str_fail
0385   2???               M         call copystring
                      00851         COPY_DEC1 cl_fail
0386   0852               M         movf cl_fail,   w
0387   00BB               M         movwf arg
0388   3001               M         movlw 0x01
0389   00BC               M         movwf arg2
038A   2???               M         call copydec
038B   0008           00852         return
038C                  00853 ML_report_6
                      00854         COPY_STRING str_layout
038C   30??               M         movlw str_layout
038D   2???               M         call copystring
038E   0008           00855         return
038F                  00856 ML_report_7
                      00857         COPY_STRING str_layout1
038F   30??               M         movlw str_layout1
0390   2???               M         call copystring
                      00858         COPY_LAYOUT 0
0391   3000               M         movlw 0
0392   2???               M         call copylayout
0393   0008           00859         return
0394                  00860 ML_report_8
                      00861         COPY_STRING str_layout2
0394   30??               M         movlw str_layout2
0395   2???               M         call copystring
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00862         COPY_LAYOUT 1
0396   3001               M         movlw 1
0397   2???               M         call copylayout
0398   0008           00863         return
0399                  00864 ML_report_9
                      00865         COPY_STRING str_layout3
0399   30??               M         movlw str_layout3
039A   2???               M         call copystring
                      00866         COPY_LAYOUT 2
039B   3002               M         movlw 2
039C   2???               M         call copylayout
039D   0008           00867         return
039E                  00868 ML_report_10
                      00869         COPY_STRING str_layout4
039E   30??               M         movlw str_layout4
039F   2???               M         call copystring
                      00870         COPY_LAYOUT 3
03A0   3003               M         movlw 3
03A1   2???               M         call copylayout
03A2   0008           00871         return
03A3                  00872 ML_run_0
                      00873         COPY_STRING str_running
03A3   30??               M         movlw str_running
03A4   2???               M         call copystring
03A5   0008           00874         return
03A6                  00875 ML_run_1
                      00876         COPY_STRING str_null
03A6   30??               M         movlw str_null
03A7   2???               M         call copystring
03A8   0008           00877         return
03A9                  00878 ML_finish_0
                      00879         COPY_STRING str_insp_fin
03A9   30??               M         movlw str_insp_fin
03AA   2???               M         call copystring
03AB   0008           00880         return
03AC                  00881 ML_finish_1 ; ALL PASS????!!!!
                      00882         COPY_STRING str_runtime
03AC   30??               M         movlw str_runtime
03AD   2???               M         call copystring
                      00883         COPY_DEC1 runtime
03AE   084F               M         movf runtime,   w
03AF   00BB               M         movwf arg
03B0   3001               M         movlw 0x01
03B1   00BC               M         movwf arg2
03B2   2???               M         call copydec
                      00884         COPY_STRING str_s
03B3   30??               M         movlw str_s
03B4   2???               M         call copystring
03B5   0008           00885         return
                      00886 ;*******************************************************************************
                      00887 ; "copystring": String Copy Function
                      00888 ; Func: Copy the string literal (null terminated) pointed by W
                      00889 ; to position pointed by FSR (indirect pointer)
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00890 ; Input: W = address of the string literal wanted,
                      00891 ; FSR = adress of destination
                      00892 ; Output: FSR = adress of the null terminator of the copyed string
                      00893 ; Affect: W, STATUS, literal_addr
                      00894 ;*******************************************************************************
03B6                  00895 copystring
03B6   00BD           00896         movwf literal_addr
03B7                  00897 copystring_loop
03B7   083D           00898         movf literal_addr, w
03B8   2???           00899         call literal
03B9   0080           00900         movwf INDF
03BA   0880           00901         movf INDF, f ; test INDF(last char) == 0(NULL)
03BB   1903           00902         btfsc STATUS, Z
03BC   0008           00903         return ; if end of string is reached (NULL)
03BD   0A84           00904         incf FSR, f
03BE   0ABD           00905         incf literal_addr, f
03BF   2???           00906         goto copystring_loop
                      00907 ;*******************************************************************************
                      00908 ; "copylayout": Layout Row Translate & Copy Function
                      00909 ; Func: Translate a row in layout array into printable format,
                      00910 ; copy it to position pointed by FSR,
                      00911 ; and add a null termination after the copied charactor
                      00912 ; Input: W = raw number, FSR = adress of destination
                      00913 ; Output: FSR = adress of the null terminator after copied layout
                      00914 ; Affect:
                      00915 ;*******************************************************************************
03C0                  00916 copylayout
03C0   00B4           00917         movwf temp ; raw number, later hold translated layout byte
03C1   3053           00918         movlw layout
03C2   08B4           00919         movf temp, f ; test if temp == 0
03C3   1903           00920         btfsc STATUS, Z
03C4   2???           00921         goto copylayout_next ; temp == 0, starting position = layout
03C5                  00922 copylayout_startloop
03C5   3E05           00923         addlw COLS
03C6   0BB4           00924         decfsz temp, f
03C7   2???           00925         goto copylayout_startloop
03C8                  00926 copylayout_next
03C8   00B5           00927         movwf temp2 ; address of layout byte
03C9   0804           00928         movf FSR, w
03CA   00B6           00929         movwf temp3 ; address of destination
03CB   3005           00930         movlw COLS
03CC   00B7           00931         movwf temp4 ; colume counter
03CD                  00932 copylayout_charloop
03CD   0835           00933         movf temp2, w ; get layout byte
03CE   0084           00934         movwf FSR
03CF   30??           00935         movlw char_layout ; get translated layout byte address
03D0   0700           00936         addwf INDF, w
03D1   2???           00937         call literal ; translate char
03D2   00B4           00938         movwf temp ; save the translated layout byte into temp
03D3   0836           00939         movf temp3, w ; get destination
03D4   0084           00940         movwf FSR
03D5   0834           00941         movf temp, w ; copy translated byte to destination
Warning[203]: Found opcode in column 1. (movwf)
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

03D6   0080           00942 movwf INDF
03D7   0AB5           00943         incf temp2, f
03D8   0AB6           00944         incf temp3, f
03D9   0BB7           00945         decfsz temp4, f
03DA   2???           00946         goto copylayout_charloop
03DB   0836           00947         movf temp3, w
03DC   0084           00948         movwf FSR ; FSR will now have the address after last byte
03DD   3000           00949         movlw NULL ; add null terminator
03DE   0080           00950         movwf INDF
03DF   0008           00951         return
                      00952 ;*******************************************************************************
                      00953 ; "copydec": Byte Display Conversion & Copy Function
                      00954 ; Func: Convert a number store in a byte to a printable decimal
                      00955 ; ASCII string with null termination and copy it to a position
                      00956 ; pointed by FSR
                      00957 ; Input: arg = number to be converted,
                      00958 ; arg2 = minimum number of digits displayed
                      00959 ; FSR = adress of destination
                      00960 ; Output: FSR = adress of the null terminator of the decimal display
                      00961 ; Affect: W, STATUS, arith_temp, arith_temp2
                      00962 ;*******************************************************************************
03E0                  00963 copydec
03E0   083B           00964         movf arg, w
                      00965         DIVLW 0x64 ; 100
03E1   00EA               M         movwf arith_temp
03E2   3064               M         movlw 0x64
03E3   2???               M         call divfn
03E4   1D03           00966         btfss STATUS, Z ; test if quotient is 0
03E5   2???           00967         goto copydec_copyhundreds ; quotient <> 0, normal display
03E6   3003           00968         movlw 0x03 ; quotient == 0, depends on arg2
03E7   023C           00969         subwf arg2, w
03E8   1C03           00970         btfss STATUS, C ; test if arg2 < 3
03E9   2???           00971         goto copydec_tens ; arg2 < 3, skip 0 hundred
03EA   3000           00972         movlw 0x00 ; arg2 >= 3, display 0
03EB                  00973 copydec_copyhundreds
03EB   3E30           00974         addlw 0x30 ; num+0x30 = its ASCII
03EC   0080           00975         movwf INDF
03ED   0A84           00976         incf FSR, f
03EE   3003           00977         movlw 0x03 ; hundreds already displayed, set arg2 to 3
03EF   00BC           00978         movwf arg2 ; because all following digit shall be seen
03F0                  00979 copydec_tens
03F0   083B           00980         movf arg, w
                      00981         MODLW 0x64 ; 100
03F1   00EA               M         movwf arith_temp
03F2   3064               M         movlw 0x64
03F3   2???               M         call divfn
03F4   086A               M         movf arith_temp, w
                      00982         DIVLW 0x0A ; 10
03F5   00EA               M         movwf arith_temp
03F6   300A               M         movlw 0x0A
03F7   2???               M         call divfn
03F8   1D03           00983         btfss STATUS, Z ; test if quotient is 0
03F9   2???           00984         goto copydec_copytens ; quotient <> 0, normal display
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

03FA   3002           00985         movlw 0x02 ; quotient == 0, depends on arg2
03FB   023C           00986         subwf arg2, w
03FC   1C03           00987         btfss STATUS, C ; test if arg2 < 2
03FD   2???           00988         goto copydec_ones ; arg2 < 2, skip 0 tens
03FE   3000           00989         movlw 0x00 ; arg2 >= 2, display 0
03FF                  00990 copydec_copytens
03FF   3E30           00991         addlw 0x30 ; num+0x30 = its ASCII
0400   0080           00992         movwf INDF
0401   0A84           00993         incf FSR, f
                      00994         ; movlw 0x02 ; tens already displayed, set arg2 to 2
                      00995         ; movwf arg2 ; because all following digit shall be seen
0402                  00996 copydec_ones
0402   083B           00997         movf arg, w
                      00998         MODLW 0x0A ; 10
0403   00EA               M         movwf arith_temp
0404   300A               M         movlw 0x0A
0405   2???               M         call divfn
0406   086A               M         movf arith_temp, w
                      00999         ; ones shall be displayed anyways
0407   3E30           01000         addlw 0x30 ; num+0x30 = its ASCII
0408   0080           01001         movwf INDF
0409   0A84           01002         incf FSR, f
040A                  01003 copydec_ending ; write a null ending
040A   3000           01004         movlw NULL
040B   0080           01005         movwf INDF
040C   0008           01006         return
                      01007 ;*******************************************************************************
                      01008 ; "writeline": Write Displayable Line to LCD Function
                      01009 ; Func: Send LCDline string to LCD charactor by charactor
                      01010 ; Input: None (string prepared in LCDline)
                      01011 ; Output: None (to LCD)
                      01012 ; Affect: W, STATUS, FSR, delaytemp, delaycount
                      01013 ; Runtime: (3.2 + 216.0 * N) us, N = # of char, not including NULL
                      01014 ;*******************************************************************************
040D                  01015 writeline
                      01016         MOVLF FSR, LCDline
040D   3023               M         movlw LCDline
040E   0084               M         movwf FSR
040F                  01017 writeline_loop
040F   0800           01018         movf INDF, w ; test INDF(char pointer to the string)==0(NULL)
0410   1903           01019         btfsc STATUS, Z
0411   0008           01020         return ; if end of string is reached (NULL)
0412   2???           01021         call LCD_wt
0413   0A84           01022         incf FSR, f
0414   2???           01023         goto writeline_loop
                      01024 ;*******************************************************************************
                      01025 ; "Run": Run Inspection Function
                      01026 ; Func: Control the entire process of inspection
                      01027 ; Input: None
                      01028 ; Output: st_year, st_month, st_day, st_hour, st_min, st_sec,
                      01029 ; end_hour, end_min, end_sec, runtime, cl_total, cl_pass,
                      01030 ; cl_fail, layout, smotor_dir, log!!!!
                      01031 ; Affect:
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01032 ;*******************************************************************************
0415                  01033 run
                      01034         ; store sarting time
                      01035         MOVFF st_year, rt_year
0415   0840               M         movf rt_year, w
0416   00C6               M         movwf st_year
                      01036         MOVFF st_month, rt_month
0417   0841               M         movf rt_month, w
0418   00C7               M         movwf st_month
                      01037         MOVFF st_day, rt_day
0419   0842               M         movf rt_day, w
041A   00C8               M         movwf st_day
                      01038         MOVFF st_hour, rt_hour
041B   0843               M         movf rt_hour, w
041C   00C9               M         movwf st_hour
                      01039         MOVFF st_min, rt_min
041D   0844               M         movf rt_min, w
041E   00CA               M         movwf st_min
                      01040         MOVFF st_sec, rt_sec
041F   0845               M         movf rt_sec, w
0420   00CB               M         movwf st_sec
                      01041         ; reset all layouts
                      01042         MOVLF FSR, layout
0421   3053               M         movlw layout
0422   0084               M         movwf FSR
                      01043         MOVLF temp, MAXPOS
0423   3014               M         movlw MAXPOS
0424   00B4               M         movwf temp
0425                  01044 run_clearlayoutloop
0425   0180           01045         clrf INDF
0426   0A84           01046         incf FSR, f
0427   0BB4           01047         decfsz temp, f
0428   2???           01048         goto run_clearlayoutloop
                      01049         ; initialize variables
0429   3053           01050         movlw layout
042A   08E7           01051         movf smotor_dir, f
042B   1903           01052         btfsc STATUS, Z
042C   2???           01053         goto run_init_smotornext; smotor_dir == 0, "row1" to "row4"
042D   3E14           01054         addlw MAXPOS ; smotor_dir <> 0, "row4" to "row1"
042E   00B4           01055         movwf temp ; temperary storage
042F   3005           01056         movlw COLS
0430   0234           01057         subwf temp, w ; layout + MAXPOS - COLS, at last row
0431                  01058 run_init_smotornext
0431   00BF           01059         movwf result_addr
                      01060         MOVLF rowleft, ROWS
0432   3004               M         movlw ROWS
0433   00BE               M         movwf rowleft
0434   01D0           01061         clrf cl_total
0435   01D1           01062         clrf cl_pass
0436   01D2           01063         clrf cl_fail
0437   100B           01064         bcf INTCON, RBIF
0438   158B           01065         bsf INTCON, RBIE ; enable keypad interrept
                      01066         STORE_LIGHT light_bg
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0439   30B0               M         movlw light_bg
043A   2???               M         call lightsensor
                      01067         PRINT_DOT ; !!!!
                          M         MOVLF FSR, LCDline
043B   3023               M         movlw LCDline
043C   0084               M         movwf FSR
                          M         COPY_STRING str_dot
043D   30??               M         movlw str_dot
043E   2???               M         call copystring
043F   2???               M         call writeline
0440                  01068 run_loop
                      01069         IRLED_ON
0440   3001               M         movlw 0x01
0441   2???               M         call ledcontrol
                      01070         STORE_LIGHT light_pos
0442   30B5               M         movlw light_pos
0443   2???               M         call lightsensor
                      01071         IRLED_OFF
0444   3000               M         movlw 0x00
0445   2???               M         call ledcontrol
0446   083F           01072         movf result_addr, w
                      01073         CALC_POS THD_IRLED
0447   00B4               M         movwf temp
0448   301C               M         movlw THD_IRLED
0449   00B7               M         movwf temp4
044A   2???               M         call calcpos
044B   1903           01074         btfsc STATUS, Z
044C   2???           01075         goto run_noextrarow ; return value == 0, no lights in this row
                      01076         ;PRESS_CL
044D   2???           01077         call movedown
                      01078         STORE_LIGHT light_pos
044E   30B5               M         movlw light_pos
044F   2???               M         call lightsensor
                      01079         CALC_POS THD_CL3LED
0450   00B4               M         movwf temp
0451   3050               M         movlw THD_CL3LED
0452   00B7               M         movwf temp4
0453   2???               M         call calcpos
0454   2???           01080         call moveup
                      01081         STORE_LIGHT light_cl
0455   30BA               M         movlw light_cl
0456   2???               M         call lightsensor
                      01082         PRINT_DOT ; !!!!
                          M         MOVLF FSR, LCDline
0457   3023               M         movlw LCDline
0458   0084               M         movwf FSR
                          M         COPY_STRING str_dot
0459   30??               M         movlw str_dot
045A   2???               M         call copystring
045B   2???               M         call writeline
                      01083         ;PRESS_CL
045C   2???           01084         call movedown
045D   2???           01085         call moveup
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01086         STORE_LIGHT light_off
045E   30BF               M         movlw light_off
045F   2???               M         call lightsensor
                      01087         PRINT_DOT ; !!!!
                          M         MOVLF FSR, LCDline
0460   3023               M         movlw LCDline
0461   0084               M         movwf FSR
                          M         COPY_STRING str_dot
0462   30??               M         movlw str_dot
0463   2???               M         call copystring
0464   2???               M         call writeline
0465   083F           01088         movf result_addr, w
0466   2???           01089         call calcfunc
0467   3E00           01090         addlw 0x00
0468   1903           01091         btfsc STATUS, Z
0469   2???           01092         goto run_noextrarow ; return value == 0, no extra row
                      01093         ; return value <> 0, advance extra row
                      01094         ; advance to next RAM location
046A   3005           01095         movlw COLS
046B   08E7           01096         movf smotor_dir, f
046C   1D03           01097         btfss STATUS, Z
046D   2???           01098         goto run_nextRAM_reverse; smotor_dir<>0, "row4" to "row1", sub COLS
046E   07BF           01099         addwf result_addr, f ; smotor_dir == 0, "row1" to "row4", add COLS
046F   2???           01100         goto run_nextRAM_next
0470                  01101 run_nextRAM_reverse
0470   02BF           01102         subwf result_addr, f
0471                  01103 run_nextRAM_next
0471   03BE           01104         decf rowleft, f
0472   1903           01105         btfsc STATUS, Z
0473   2???           01106         goto run_end ; no row left, end run
0474   2???           01107         call advancerow ; advance to next machine location
                      01108         PRINT_DOT ; !!!!
                          M         MOVLF FSR, LCDline
0475   3023               M         movlw LCDline
0476   0084               M         movwf FSR
                          M         COPY_STRING str_dot
0477   30??               M         movlw str_dot
0478   2???               M         call copystring
0479   2???               M         call writeline
047A                  01109 run_noextrarow
                      01110         ; advance to next RAM location
047A   3005           01111         movlw COLS
047B   08E7           01112         movf smotor_dir, f
047C   1D03           01113         btfss STATUS, Z
047D   2???           01114         goto run_nextRAM_reverse2 ; smotor_dir <> 0, "row4" to "row1"
047E   07BF           01115         addwf result_addr, f ; smotor_dir == 0, "row1" to "row4", add COLS
047F   2???           01116         goto run_nextRAM_next2
0480                  01117 run_nextRAM_reverse2
0480   02BF           01118         subwf result_addr, f
0481                  01119 run_nextRAM_next2
0481   03BE           01120         decf rowleft, f
0482   1903           01121         btfsc STATUS, Z
0483   2???           01122         goto run_end ; no row left, end run
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0484   2???           01123         call advancerow ; advance to next machine location
                      01124         PRINT_DOT ; !!!!
                          M         MOVLF FSR, LCDline
0485   3023               M         movlw LCDline
0486   0084               M         movwf FSR
                          M         COPY_STRING str_dot
0487   30??               M         movlw str_dot
0488   2???               M         call copystring
0489   2???               M         call writeline
048A   2???           01125         goto run_loop
048B                  01126 run_end
048B   118B           01127         bcf INTCON, RBIE ; disable keypad interrept
048C   3001           01128         movlw 0x01 ; mask last bit
048D   06E7           01129         xorwf smotor_dir, f ; logic NOT last digit, reverse direction
                      01130         ; store end time
                      01131         MOVFF end_hour, rt_hour
048E   0843               M         movf rt_hour, w
048F   00CC               M         movwf end_hour
                      01132         MOVFF end_min, rt_min
0490   0844               M         movf rt_min, w
0491   00CD               M         movwf end_min
                      01133         MOVFF end_sec, rt_sec
0492   0845               M         movf rt_sec, w
0493   00CE               M         movwf end_sec
0494   2???           01134         call calcruntime
0495   2???           01135         call writelog
0496   00A1           01136         movwf report_num
0497   0008           01137         return
                      01138 ;*******************************************************************************
                      01139 ; "calcpos": Row Position Calculation Function
                      01140 ; Func: Determine the existance of closet light at any positions in
                      01141 ; current row: result CL_POS_BIT = (light_pos >= THD_IRLED)
                      01142 ; Input: W = the starting address where the result will be stored,
                      01143 ; temp = address of the result, temp4 = threshold, light_pos[]
                      01144 ; Output: W = number of lights in current row, result bytes,
                      01145 ; STATUS is set according to W
                      01146 ; Affect: FSR, temp, temp2, temp3, temp4
                      01147 ;*******************************************************************************
0498                  01148 calcpos
                      01149         ; movwf temp ; address of the result
0498   01B5           01150         clrf temp2 ; colume number
0499   01B6           01151         clrf temp3 ; number of CLs in current row
049A                  01152 calcpos_loop
                      01153         MOVFF FSR, temp
049A   0834               M         movf temp, w
049B   0084               M         movwf FSR
049C   30B5           01154         movlw light_pos
049D   0735           01155         addwf temp2, w
049E   0084           01156         movwf FSR ; get current light_pos
049F   0837           01157         movf temp4, w
04A0   0200           01158         subwf INDF, w ; light_pos - threshold
04A1   1C03           01159         btfss STATUS, C
04A2   2???           01160         goto calcpos_next ; light_pos < threshold, no light
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01161         MOVFF FSR, temp ; light_pos >= threshold, has light
04A3   0834               M         movf temp, w
04A4   0084               M         movwf FSR
04A5   1400           01162         bsf INDF, CL_POS_BIT ; set pos bit
04A6   0AB6           01163         incf temp3, f
04A7                  01164 calcpos_next
04A7   0AB4           01165         incf temp, f
04A8   0AB5           01166         incf temp2, f
04A9   3005           01167         movlw COLS
04AA   0235           01168         subwf temp2, w ; temp2(col#) - COLS(max col#)
04AB   1C03           01169         btfss STATUS, C
04AC   2???           01170         goto calcpos_loop ; temp2(col#) < COLS(max col#)
04AD   0836           01171         movf temp3, w
04AE   0008           01172         return
                      01173 ;*******************************************************************************
                      01174 ; "calcfunc": Row Functionality Calculation Function
                      01175 ; Func: Determine the functionality of closet light at ANY positions
                      01176 ; (not only those maked pos) of current row, also determine
                      01177 ; whether next row can physically have any CL
                      01178 ; Input: W = the starting address where the result will be stored,
                      01179 ; light_bg[], light_cl[], light_off[], result bytes
                      01180 ; Output: W = whether the machine need to advance one more row
                      01181 ; (0 = advance one row; 1 = advance two rows),
                      01182 ; cl_total, cl_pass, cl_fail, layout[]
                      01183 ; Affect: STATUS, FSR, temp, temp2, temp3, temp4, temp5, temp6, temp7
                      01184 ;*******************************************************************************
04AF                  01185 calcfunc
Warning[203]: Found opcode in column 1. (movwf)
04AF   00B4           01186 movwf temp ; address of the result
Warning[203]: Found opcode in column 1. (clrf)
04B0   01B5           01187 clrf temp2 ; colume number
Warning[203]: Found opcode in column 1. (clrf)
04B1   01B6           01188 clrf temp3 ; C0 = light_pos >= THD_IRLED
Warning[203]: Found opcode in column 1. (clrf)
04B2   01B7           01189 clrf temp4 ; C1 = light_cl >= THD_CL3LED
Warning[203]: Found opcode in column 1. (clrf)
04B3   01B8           01190 clrf temp5 ; C2 = light_off >= (lihgt_bg + THD_BG)
Warning[203]: Found opcode in column 1. (clrf)
04B4   01B9           01191 clrf temp6 ; number of CLs in current row
Warning[203]: Found opcode in column 1. (clrf)
04B5   01BA           01192 clrf temp7 ; temperaty storage
04B6                  01193 calcfunc_loop
                      01194 ; get C0 = CL_POS_BIT from calcpos
Warning[206]: Found call to macro in column 1. (MOVFF)
                      01195 MOVFF FSR, temp
04B6   0834               M         movf temp, w
04B7   0084               M         movwf FSR
Warning[203]: Found opcode in column 1. (movlw)
04B8   3000           01196 movlw FALSE
Warning[203]: Found opcode in column 1. (btfsc)
04B9   1800           01197 btfsc INDF, CL_POS_BIT
Warning[203]: Found opcode in column 1. (movlw)
04BA   30FF           01198 movlw TRUE ; CL_POS_BIT set, C0 = true
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[203]: Found opcode in column 1. (movwf)
04BB   00B6           01199 movwf temp3
                      01200 ; get C1 = light_cl >= THD_CL3LED
Warning[203]: Found opcode in column 1. (movlw)
04BC   30BA           01201 movlw light_cl
Warning[203]: Found opcode in column 1. (addwf)
04BD   0735           01202 addwf temp2, w
Warning[203]: Found opcode in column 1. (movwf)
04BE   0084           01203 movwf FSR ; get current light_cl
Warning[203]: Found opcode in column 1. (movlw)
04BF   3050           01204 movlw THD_CL3LED
Warning[203]: Found opcode in column 1. (subwf)
04C0   0200           01205 subwf INDF, w ; light_cl - THD_CL3LED
Warning[203]: Found opcode in column 1. (btfss)
04C1   1C03           01206 btfss STATUS, C
Warning[203]: Found opcode in column 1. (goto)
04C2   2???           01207 goto calcfunc_C1false ; light_pos < THD_IRLED, C1 = false
Warning[203]: Found opcode in column 1. (movlw)
04C3   30FF           01208 movlw TRUE ; light_pos >= THD_IRLED, C1 = ture
Warning[203]: Found opcode in column 1. (goto)
04C4   2???           01209 goto calcfunc_C1next
04C5                  01210 calcfunc_C1false
Warning[203]: Found opcode in column 1. (movlw)
04C5   3000           01211 movlw FALSE
04C6                  01212 calcfunc_C1next
Warning[203]: Found opcode in column 1. (movwf)
04C6   00B7           01213 movwf temp4
                      01214 ; get C2 = light_off >= (lihgt_bg + THD_BG)
Warning[203]: Found opcode in column 1. (movlw)
04C7   30B0           01215 movlw light_bg
Warning[203]: Found opcode in column 1. (addwf)
04C8   0735           01216 addwf temp2, w
Warning[203]: Found opcode in column 1. (movwf)
04C9   0084           01217 movwf FSR ; get current light_bg
Warning[203]: Found opcode in column 1. (movlw)
04CA   3005           01218 movlw THD_BG
Warning[203]: Found opcode in column 1. (addwf)
04CB   0700           01219 addwf INDF, w ; lihgt_bg + THD_BG
Warning[203]: Found opcode in column 1. (movwf)
04CC   00BA           01220 movwf temp7 ; temperally save
Warning[203]: Found opcode in column 1. (movlw)
04CD   30BF           01221 movlw light_off
Warning[203]: Found opcode in column 1. (addwf)
04CE   0735           01222 addwf temp2, w
Warning[203]: Found opcode in column 1. (movwf)
04CF   0084           01223 movwf FSR ; get current light_off
Warning[203]: Found opcode in column 1. (movf)
04D0   083A           01224 movf temp7, w ; put (lihgt_bg + THD_BG) back
Warning[203]: Found opcode in column 1. (subwf)
04D1   0200           01225 subwf INDF, w ; light_off - (lihgt_bg + THD_BG)
Warning[203]: Found opcode in column 1. (btfss)
04D2   1C03           01226 btfss STATUS, C
Warning[203]: Found opcode in column 1. (goto)
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

04D3   2???           01227 goto calcfunc_C2false ; light_off < (lihgt_bg - THD_BG), C2 = false
Warning[203]: Found opcode in column 1. (movlw)
04D4   30FF           01228 movlw TRUE ; light_off >= (lihgt_bg - THD_BG), C2 = true
Warning[203]: Found opcode in column 1. (goto)
04D5   2???           01229 goto calcfunc_C2next
04D6                  01230 calcfunc_C2false
Warning[203]: Found opcode in column 1. (movlw)
04D6   3000           01231 movlw FALSE
04D7                  01232 calcfunc_C2next
Warning[203]: Found opcode in column 1. (movwf)
04D7   00B8           01233 movwf temp5
                      01234 ; determine the functionality of CL:
Warning[206]: Found call to macro in column 1. (MOVFF)
                      01235 MOVFF FSR, temp
04D8   0834               M         movf temp, w
04D9   0084               M         movwf FSR
Warning[203]: Found opcode in column 1. (clrf)
04DA   0180           01236 clrf INDF ; reset layout byte
                      01237 ; CL_POS_BIT = C0 IOR C1 IOR C2
Warning[203]: Found opcode in column 1. (movf)
04DB   0836           01238 movf temp3, w ; W = C0
Warning[203]: Found opcode in column 1. (iorwf)
04DC   0437           01239 iorwf temp4, w ; W = C0 IOR C1
Warning[203]: Found opcode in column 1. (iorwf)
04DD   0438           01240 iorwf temp5, w ; W = C0 IOR C1 IOR C2
Warning[203]: Found opcode in column 1. (btfsc)
04DE   1903           01241 btfsc STATUS, Z
Warning[203]: Found opcode in column 1. (goto)
04DF   2???           01242 goto calcfunc_POSfalse ; W == 0, false
Warning[203]: Found opcode in column 1. (bsf)
04E0   1400           01243 bsf INDF, CL_POS_BIT ; W <> 0, true
Warning[203]: Found opcode in column 1. (incf)
04E1   0AD0           01244 incf cl_total, f
Warning[203]: Found opcode in column 1. (incf)
04E2   0AB9           01245 incf temp6, f
04E3                  01246 calcfunc_POSfalse
                      01247 ; CL_FN_BIT = (C1 AND (NOT C2)) IOR (C0 AND (NOT C1) AND C2)
Warning[203]: Found opcode in column 1. (movf)
04E3   0838           01248 movf temp5, w ; W = C2
Warning[203]: Found opcode in column 1. (xorlw)
04E4   3AFF           01249 xorlw 0xFF ; W = NOT C2
Warning[203]: Found opcode in column 1. (andwf)
04E5   0537           01250 andwf temp4, w ; W = C1 AND (NOT C2)
04E6   00BA           01251  movwf temp7 ; temperally save
Warning[203]: Found opcode in column 1. (movf)
04E7   0837           01252 movf temp4, w ; W = C1
Warning[203]: Found opcode in column 1. (xorlw)
04E8   3AFF           01253 xorlw 0xFF ; W = NOT C1
Warning[203]: Found opcode in column 1. (andwf)
04E9   0536           01254 andwf temp3, w ; W = C0 AND (NOT C1)
Warning[203]: Found opcode in column 1. (andwf)
04EA   0538           01255 andwf temp5, w ; W = C0 AND (NOT C1) AND C2
Warning[203]: Found opcode in column 1. (iorwf)
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

04EB   043A           01256 iorwf temp7, w ; W = (C1 AND(NOT C2))IOR(C0 AND(NOT C1)AND C2)
Warning[203]: Found opcode in column 1. (btfsc)
04EC   1903           01257 btfsc STATUS, Z
Warning[203]: Found opcode in column 1. (goto)
04ED   2???           01258 goto calcfunc_FNfalse ; W == 0, false
Warning[203]: Found opcode in column 1. (bsf)
04EE   1480           01259 bsf INDF, CL_FN_BIT ; W <> 0, true
Warning[203]: Found opcode in column 1. (incf)
04EF   0AD1           01260 incf cl_pass, f
04F0                  01261 calcfunc_FNfalse
                      01262 ; CL_ERR_BIT = (C1 AND (NOT C0)) IOR (C2 AND (NOT C1))
Warning[203]: Found opcode in column 1. (movf)
04F0   0837           01263 movf temp4, w ; W = C1
Warning[203]: Found opcode in column 1. (xorlw)
04F1   3AFF           01264 xorlw 0xFF ; W = NOT C1
Warning[203]: Found opcode in column 1. (andwf)
04F2   0538           01265 andwf temp5, w ; W = C2 AND (NOT C1)
Warning[203]: Found opcode in column 1. (movwf)
04F3   00BA           01266 movwf temp7 ; temperally save
Warning[203]: Found opcode in column 1. (movf)
04F4   0836           01267 movf temp3, w ; W = C0
Warning[203]: Found opcode in column 1. (xorlw)
04F5   3AFF           01268 xorlw 0xFF ; W = NOT C0
Warning[203]: Found opcode in column 1. (andwf)
04F6   0537           01269 andwf temp4, w ; W = C1 AND (NOT C0)
Warning[203]: Found opcode in column 1. (iorwf)
04F7   043A           01270 iorwf temp7, w ; W = (C1 AND (NOT C0)) IOR (C2 AND (NOT C1))
Warning[203]: Found opcode in column 1. (btfss)
04F8   1D03           01271 btfss STATUS, Z
Warning[203]: Found opcode in column 1. (bsf)
04F9   1500           01272 bsf INDF, CL_ERR_BIT ; W <> 0, true
Warning[203]: Found opcode in column 1. (incf)
04FA   0AB4           01273 incf temp, f
Warning[203]: Found opcode in column 1. (incf)
04FB   0AB5           01274 incf temp2, f
Warning[203]: Found opcode in column 1. (movlw)
04FC   3005           01275 movlw COLS
Warning[203]: Found opcode in column 1. (subwf)
04FD   0235           01276 subwf temp2, w ; temp2(col#) - COLS(max col#)
Warning[203]: Found opcode in column 1. (btfss)
04FE   1C03           01277 btfss STATUS, C
Warning[203]: Found opcode in column 1. (goto)
04FF   2???           01278 goto calcfunc_loop ; temp2(col#) < COLS(max col#)
                      01279 ; cl_fail = cl_total - cl_pass
Warning[203]: Found opcode in column 1. (movf)
0500   0851           01280 movf cl_pass, w
Warning[203]: Found opcode in column 1. (subwf)
0501   0250           01281 subwf cl_total, w ; cl_total - cl_pass
Warning[203]: Found opcode in column 1. (movwf)
0502   00D2           01282 movwf cl_fail
                      01283 ; advance two rows if "CLs in this row" >= MAXCLINROW
Warning[203]: Found opcode in column 1. (movlw)
0503   3003           01284 movlw MAXCLINROW
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[203]: Found opcode in column 1. (subwf)
0504   0239           01285 subwf temp6, w ; "CLs in this row" - MAXCLINROW
Warning[203]: Found opcode in column 1. (btfss)
0505   1C03           01286 btfss STATUS, C
Warning[203]: Found opcode in column 1. (retlw)
0506   3400           01287 retlw 0x00 ; "CLs in this row" < MAXCLINROW
Warning[203]: Found opcode in column 1. (retlw)
0507   3401           01288 retlw 0x01 ; "CLs in this row" >= MAXCLINROW
                      01289 ;*******************************************************************************
                      01290 ; "calcruntime": Runtime Calculation Function
                      01291 ; Func: Calculate the running time of the run = endtime - starttime
                      01292 ; Input: st_min, st_sec, end_min, end_sec
                      01293 ; Output: runtime
                      01294 ; Affect: W, STATUS, temp
                      01295 ;*******************************************************************************
0508                  01296 calcruntime
0508   084A           01297     movf st_min, w ; temp = end_min - st_min
0509   024D           01298     subwf end_min, w
050A   1803           01299     btfsc STATUS, C
050B   2???           01300     goto calcruntime_next1
050C   3E3C           01301     addlw .60 ; borrow occur, +60min
050D                  01302 calcruntime_next1
050D   00B4           01303     movwf temp
050E   084B           01304     movf st_sec, w ; W = end_sec - st_sec
050F   024E           01305     subwf end_sec, w
0510   1803           01306     btfsc STATUS, C
0511   2???           01307     goto calcruntime_next2
0512   3E3C           01308     addlw .60 ; borrow occur, +60sec
0513   03B4           01309     decf temp, f ; -1min
0514                  01310 calcruntime_next2
0514   08B4           01311     movf temp, f
0515   1903           01312     btfsc STATUS, Z
0516   2???           01313     goto calcruntime_next3 ; temp == 0, runtime = W
0517                  01314 calcruntime_loop ; runtime = W + .60*temp
0517   3E3C           01315     addlw .60
0518   1803           01316     btfsc STATUS, C
0519   2???           01317     goto calcruntime_overflow ; W>255 overflow
051A   0BB4           01318     decfsz temp, f
051B   2???           01319     goto calcruntime_loop
051C                  01320 calcruntime_next3
051C   00CF           01321     movwf runtime
051D   0008           01322     return
051E                  01323 calcruntime_overflow
051E   30FF           01324     movlw 0xFF ; !!!!
051F   00CF           01325     movwf runtime
0520   0008           01326     return
                      01327 ;*******************************************************************************
                      01328 ; "lightsensor": Light Sensor Read, A/D Convert, and Store Function
                      01329 ; Func: Read in analog signal from light sensor, convert it to
                      01330 ; digital, and store the most significant 8-bit result to
                      01331 ; designated address, convert voltage reading to intensity,
                      01332 ; take average of LIGHTAVGX readings,
                      01333 ; repeat COLS times for a row
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01334 ; Input: W = the staring address where the readings will be stored
                      01335 ; Output: readings store into designated bytes
                      01336 ; Affect: W, STATUS, FSR, ADCON0, ADRESH, ADRESL, temp, temp2, temp3
                      01337 ; delaytemp, delaycount, arith_temp, arith_temp2
                      01338 ;*******************************************************************************
0521                  01339 lightsensor
0521   0084           01340     movwf FSR
0522   01B4           01341     clrf temp ; CHS (Channel Select) bits
                      01342     MOVLF temp2, COLS ; number of colume left
0523   3005               M         movlw COLS
0524   00B5               M         movwf temp2
0525                  01343 lightsensor_loop_col
0525   30C7           01344     movlw B'11000111' ; mask CHS bits
0526   059F           01345     andwf ADCON0, f ; clear CHS bits
0527   0834           01346     movf temp, w
0528   049F           01347     iorwf ADCON0, f ; set CHS bits
                      01348     ; avergae = (X1/n) + (X2/n) + ... + (Xn/n)
                      01349     MOVLF temp3, LIGHTAVGX ; count of sample light sensor reading
0529   3004               M         movlw LIGHTAVGX
052A   00B6               M         movwf temp3
052B   0180           01350     clrf INDF
052C                  01351 lightsensor_loop_avg
052C   2???           01352     call delay50us ; require 2Tosc + Tacq = 28us
052D   151F           01353     bsf ADCON0, GO
052E                  01354 lightsensor_poll ; about 40us
052E   191F           01355     btfsc ADCON0, GO
052F   2???           01356     goto lightsensor_poll
0530   081E           01357     movf ADRESH, w ; the most significant 8-bit result
0531   3AFF           01358     xorlw 0xFF ; invert result, since 5V = 0 intensity!!!!
                      01359     DIVLW LIGHTAVGX
0532   00EA               M         movwf arith_temp
0533   3004               M         movlw LIGHTAVGX
0534   2???               M         call divfn
0535   0780           01360     addwf INDF, f
0536   0BB6           01361     decfsz temp3, f
0537   2???           01362     goto lightsensor_loop_avg
0538   3008           01363     movlw B'00001000'
0539   07B4           01364     addwf temp, f ; advance CHS
053A   0A84           01365     incf FSR, f
053B   0BB5           01366     decfsz temp2, f
053C   2???           01367     goto lightsensor_loop_col
Warning[203]: Found opcode in column 1. (return)
053D   0008           01368 return
                      01369 
                      01370 ;*******************************************************************************
                      01371 ; "ledcontrol": IR LEDs Control Function
                      01372 ; Func: Turn on or off the infrared LEDs according to W
                      01373 ; Input: W = turn on or off the LED (0=off or else=on)
                      01374 ; Output: None
                      01375 ; Affect: STATUS
                      01376 ; Runtime: 3.2 us
                      01377 ;*******************************************************************************
053E                  01378 ledcontrol
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

053E   1107           01379     bcf IRLED
053F   3E00           01380     addlw 0x00
0540   1D03           01381     btfss STATUS, Z
0541   1507           01382     bsf IRLED ; if w <> 0, set IRLED
Warning[203]: Found opcode in column 1. (return)
0542   0008           01383 return
                      01384 ;*******************************************************************************
                      01385 ; "movedown": Arm Move Down Control Function
                      01386 ; Func: Order the test arm to move down to the Closet Lights
                      01387 ; Input: None
                      01388 ; Output: None
                      01389 ; Affect: VMOTOR_C0, VMOTOR_C1
                      01390 ; Runtime: ???? us
                      01391 ;*******************************************************************************
0543                  01392 movedown
0543   1509           01393     bsf SMOTOR_EN ; power s_motor to hold position
0544   1087           01394     bcf VMOTOR_C1 ; to be safe
0545   1407           01395     bsf VMOTOR_C0
                      01396     ;movedown_poll
                      01397     ; btfsc FB_BOT
                      01398     ; goto movedown_poll
0546   301E           01399     movlw DCDOWNDELAY
0547   2???           01400     call delayX100msm
0548   1007           01401     bcf VMOTOR_C0
0549   1109           01402     bcf SMOTOR_EN
Warning[203]: Found opcode in column 1. (return)
054A   0008           01403 return
                      01404 ;*******************************************************************************
                      01405 ; "moveup": Arm Move Up Control Function
                      01406 ; Func: Order the test arm to move up to its default position
                      01407 ; Input: None
                      01408 ; Output: None
                      01409 ; Affect: VMOTOR_C0, VMOTOR_C1
                      01410 ; Runtime: ???? us
                      01411 ;*******************************************************************************
054B                  01412 moveup
054B   1509           01413     bsf SMOTOR_EN ; power s_motor to hold position
054C   1007           01414     bcf VMOTOR_C0 ; to be safe
054D   1487           01415     bsf VMOTOR_C1
Warning[207]: Found label after column 1. (moveup_poll)
054E                  01416     moveup_poll
054E   1A87           01417     btfsc FB_TOP
054F   2???           01418     goto moveup_poll
0550   1087           01419     bcf VMOTOR_C1
0551   1109           01420     bcf SMOTOR_EN
Warning[203]: Found opcode in column 1. (return)
0552   0008           01421 return
                      01422 ;*******************************************************************************
                      01423 ; "advancerow": Arm Advance-to-Next-Row Control Function
                      01424 ; Func: Order the test arm to the next(determined by smotor_dir) row
                      01425 ; Input: smotor_dir = direction of stpper motor
                      01426 ; (0 = "Row 1" to "Row 4"; 1 = "Row 4" to "Row 1")
                      01427 ; Output: None
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01428 ; Affect: W, STATUS, temp, SMOTOR_EN, SMOTOR_S0, SMOTOR_S1, SMOTOR_S2,
                      01429 ; SMOTOR_S3, delaytemp, delaycount, delaytemp2, delaycount2,
                      01430 ; delaytemp3, delaycount3
                      01431 ;*******************************************************************************
0553                  01432 advancerow
0553   1088           01433     bcf SMOTOR_S1 ; state init
0554   1489           01434     bsf SMOTOR_S3
0555   1509           01435     bsf SMOTOR_EN ; start motor
0556   301C           01436     movlw SMOTOR_STEPS
0557   00B4           01437     movwf temp
0558   3006           01438     movlw SMOTOR_SPD_F ; note: w must keep its value until very end
0559   08E7           01439     movf smotor_dir, f
055A   1D03           01440     btfss STATUS, Z
055B   2???           01441     goto advancerow_backwardloop
Warning[207]: Found label after column 1. (advancerow_forwardloop)
055C                  01442     advancerow_forwardloop ; smotor_dir == 0, "Row 1" to "Row 4"
055C   1008           01443     bcf SMOTOR_S0
055D   1409           01444     bsf SMOTOR_S2
055E   1F87           01445     btfss FB_ROW4
055F   2???           01446     goto advancerow_end
0560   2???           01447     call delayX5msm
0561   1089           01448     bcf SMOTOR_S3
0562   1488           01449     bsf SMOTOR_S1
0563   1F87           01450     btfss FB_ROW4
0564   2???           01451     goto advancerow_end
0565   2???           01452     call delayX5msm
0566   1009           01453     bcf SMOTOR_S2
0567   1408           01454     bsf SMOTOR_S0
0568   1F87           01455     btfss FB_ROW4
0569   2???           01456     goto advancerow_end
056A   2???           01457     call delayX5msm
056B   1088           01458     bcf SMOTOR_S1
056C   1489           01459     bsf SMOTOR_S3
056D   1F87           01460     btfss FB_ROW4
056E   2???           01461     goto advancerow_end
056F   2???           01462     call delayX5msm
0570   0BB4           01463     decfsz temp, f
0571   2???           01464     goto advancerow_forwardloop
0572   2???           01465     goto advancerow_end
Warning[207]: Found label after column 1. (advancerow_backwardloop)
0573                  01466     advancerow_backwardloop ; smotor_dir <> 0, "Row 4" to "Row 1"
0573   1089           01467     bcf SMOTOR_S3
0574   1488           01468     bsf SMOTOR_S1
0575   2???           01469     call delayX5msm
0576   1008           01470     bcf SMOTOR_S0
0577   1409           01471     bsf SMOTOR_S2
0578   2???           01472     call delayX5msm
0579   1088           01473     bcf SMOTOR_S1
057A   1489           01474     bsf SMOTOR_S3
057B   2???           01475     call delayX5msm
057C   1009           01476     bcf SMOTOR_S2
057D   1408           01477     bsf SMOTOR_S0
057E   2???           01478     call delayX5msm
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

057F   0BB4           01479     decfsz temp, f
0580   2???           01480     goto advancerow_backwardloop
Warning[207]: Found label after column 1. (advancerow_end)
0581                  01481     advancerow_end
0581   1109           01482     bcf SMOTOR_EN
Warning[203]: Found opcode in column 1. (return)
0582   0008           01483 return
                      01484 ;*******************************************************************************
                      01485 ; "writelog": Log Write Function
                      01486 ; Func: Write the result of current run to log
                      01487 ; Input: st_year, st_month, st_day, st_hour, st_min, st_sec,
                      01488 ; runtime, layout[], log_total, log_next
                      01489 ; Output: W = current log index, log_total, log_next, Log Entry
                      01490 ; Affect: STATUS, FSR, temp, temp2, temp3, temp4,
                      01491 ; arith_temp, arith_temp2
                      01492 ;*******************************************************************************
0583                  01493 writelog
                      01494         ; starting address (indirect) offset = (log_next / MAXLOGBANK) * 0x80 + 0x10
0583   0869           01495         movf log_next, w
                      01496         DIVLW MAXLOGBANK
0584   00EA               M         movwf arith_temp
0585   3006               M         movlw MAXLOGBANK
0586   2???               M         call divfn
                      01497         MULLW 0x80
0587   00EA               M         movwf arith_temp
0588   3080               M         movlw 0x80
0589   2???               M         call mulfn
058A   3E10           01498         addlw 0x10
058B   00B4           01499         movwf temp ; save in temp
                      01500         ; starting address (indirect) = (log_next MOD MAXLOGBANK)*LOGLENGTH + offset
058C   0869           01501         movf log_next, w
                      01502         MODLW MAXLOGBANK ; W = log_next mod MAXLOGBANK
058D   00EA               M         movwf arith_temp
058E   3006               M         movlw MAXLOGBANK
058F   2???               M         call divfn
0590   086A               M         movf arith_temp, w
                      01503         MULLW LOGLENGTH
0591   00EA               M         movwf arith_temp
0592   3010               M         movlw LOGLENGTH
0593   2???               M         call mulfn
0594   0734           01504         addwf temp, w
                      01505         ; store easy-access variables
0595   1783           01506         bsf STATUS, IRP ; BANK2&3 indirect access
0596   0084           01507         movwf FSR ; log addr + 0
                      01508         MOVFF INDF, runtime
0597   084F               M         movf runtime, w
0598   0080               M         movwf INDF
0599   0A84           01509         incf FSR, f ; log addr + 1
059A   0E46           01510         swapf st_year, w
059B   0747           01511         addwf st_month, w
059C   0080           01512         movwf INDF
059D   0A84           01513         incf FSR, f ; log addr + 2
                      01514         MOVFF INDF, st_day
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

059E   0848               M         movf st_day, w
059F   0080               M         movwf INDF
05A0   0A84           01515         incf FSR, f ; log addr + 3
                      01516         MOVFF INDF, st_hour
05A1   0849               M         movf st_hour, w
05A2   0080               M         movwf INDF
05A3   0A84           01517         incf FSR, f ; log addr + 4
                      01518         MOVFF INDF, st_min
05A4   084A               M         movf st_min, w
05A5   0080               M         movwf INDF
05A6   0A84           01519         incf FSR, f ; log addr + 5
                      01520         MOVFF INDF, st_sec
05A7   084B               M         movf st_sec, w
05A8   0080               M         movwf INDF
05A9   0A84           01521         incf FSR, f ; log addr + 6
                      01522         ; store layout
                      01523         MOVFF temp, FSR ; the address of log entry (start at + 6)
05AA   0804               M         movf FSR,  w
05AB   00B4               M         movwf temp
                      01524         MOVLF temp2, layout ; address of layout bytes
05AC   3053               M         movlw layout
05AD   00B5               M         movwf temp2
                      01525         MOVLF temp3, MAXPOS ; position counter
05AE   3014               M         movlw MAXPOS
05AF   00B6               M         movwf temp3
05B0                  01526 writelog_layoutloop ; copy layout bytes in pairs
                      01527         ; write upper ribble
                      01528         MOVFF FSR, temp2 ; get first layout byte
05B0   0835               M         movf temp2, w
05B1   0084               M         movwf FSR
05B2   1383           01529         bcf STATUS, IRP ; BANK0&1 indirect access
05B3   0E00           01530         swapf INDF, w
05B4   00B7           01531         movwf temp4 ; temp4 hold the swaped layout byte temperally
                      01532         MOVFF FSR, temp ; log entry
05B5   0834               M         movf temp, w
05B6   0084               M         movwf FSR
05B7   1783           01533         bsf STATUS, IRP ; BANK2&3 indirect access
                      01534         MOVFF INDF, temp4
05B8   0837               M         movf temp4, w
05B9   0080               M         movwf INDF
05BA   0AB5           01535         incf temp2, f
05BB   03B6           01536         decf temp3, f
05BC   1903           01537         btfsc STATUS, Z
05BD   2???           01538         goto writelog_layoutnext
                      01539         ; write lower ribble
                      01540         MOVFF FSR, temp2 ; get second layout byte
05BE   0835               M         movf temp2, w
05BF   0084               M         movwf FSR
05C0   1383           01541         bcf STATUS, IRP ; BANK0&1 indirect access
                      01542         MOVFF temp4, INDF ; temp4 hold the layout byte temperally
05C1   0800               M         movf INDF, w
05C2   00B7               M         movwf temp4
                      01543         MOVFF FSR, temp ; log entry
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 45


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

05C3   0834               M         movf temp, w
05C4   0084               M         movwf FSR
05C5   1783           01544         bsf STATUS, IRP ; BANK2&3 indirect access
05C6   0837           01545         movf temp4, w
05C7   0780           01546     addwf INDF, f
05C8   0AB5           01547         incf temp2, f
05C9   0AB4           01548         incf temp, f
05CA   0BB6           01549         decfsz temp3, f
05CB   2???           01550         goto writelog_layoutloop
05CC                  01551 writelog_layoutnext
                      01552         ; calculate new log_next = (log_next + 1) MOD MAXLOG
                      01553         MOVFF temp, log_next ; save current log index in temp
05CC   0869               M         movf log_next, w
05CD   00B4               M         movwf temp
05CE   0AE9           01554         incf log_next, f
05CF   300C           01555         movlw MAXLOG ; test if max log reached
05D0   0269           01556         subwf log_next, w ; log_next + 1 - MAXLOG
05D1   1C03           01557         btfss STATUS, C
05D2   3E0C           01558         addlw MAXLOG ; log_next + 1 < MAXLOG, add MAXLOG back
05D3   00E9           01559         movwf log_next ; log_next = (log_next + 1) MOD MAXLOG
                      01560         ; calculate new log_total
05D4   300C           01561         movlw MAXLOG
05D5   0268           01562         subwf log_total, w ; log_total - MAXLOG
05D6   1C03           01563         btfss STATUS, C
05D7   0AE8           01564         incf log_total, f ; log_total < MAXLOG, increase total number
05D8   0834           01565         movf temp, w ; resume current log entry index
05D9   1383           01566         bcf STATUS, IRP ; back to BANK0&1 indirect access
05DA   0008           01567         return
                      01568 ;*******************************************************************************
                      01569 ; "readlog": Log Read Function
                      01570 ; Func: Read the log of specified run
                      01571 ; Input: W = index of wanted report
                      01572 ; Output: st_year, st_month, st_day, st_hour, st_min, st_sec,
                      01573 ; end_hour, end_min, end_sec, runtime, cl_total, cl_pass,
                      01574 ; cl_fail, layout[]
                      01575 ; Affect: W, STATUS, FSR, temp, temp2, temp3, temp4,
                      01576 ; arith_temp, arith_temp2
                      01577 ;*******************************************************************************
05DB                  01578 readlog
05DB   00B5           01579         movwf temp2 ; save the index in temp2
05DC   01D0           01580         clrf cl_total
05DD   01D1           01581         clrf cl_pass
                      01582         ; starting address (indirect) offset = (index / MAXLOGBANK) * 0x80 + 0x10
                      01583         DIVLW MAXLOGBANK
05DE   00EA               M         movwf arith_temp
05DF   3006               M         movlw MAXLOGBANK
05E0   2???               M         call divfn
                      01584         MULLW 0x80
05E1   00EA               M         movwf arith_temp
05E2   3080               M         movlw 0x80
05E3   2???               M         call mulfn
05E4   3E10           01585         addlw 0x10
05E5   00B4           01586         movwf temp ; save in temp
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 46


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01587         ; starting address (indirect) = (index MOD MAXLOGBANK)*LOGLENGTH + offset
05E6   0835           01588         movf temp2, w ; resume index
                      01589         MODLW MAXLOGBANK ; W = index mod MAXLOGBANK
05E7   00EA               M         movwf arith_temp
05E8   3006               M         movlw MAXLOGBANK
05E9   2???               M         call divfn
05EA   086A               M         movf arith_temp, w
                      01590         MULLW LOGLENGTH
05EB   00EA               M         movwf arith_temp
05EC   3010               M         movlw LOGLENGTH
05ED   2???               M         call mulfn
05EE   0734           01591         addwf temp, w
                      01592         ; read easy-access variables
05EF   1783           01593         bsf STATUS, IRP ; BANK2&3 indirect access
05F0   0084           01594         movwf FSR ; log addr + 0
                      01595         MOVFF runtime, INDF
05F1   0800               M         movf INDF, w
05F2   00CF               M         movwf runtime
05F3   0A84           01596         incf FSR, f ; log addr + 1
05F4   0E00           01597         swapf INDF, w ; swap upper 4 bits and lower 4 bits
05F5   390F           01598         andlw 0x0F ; mask the lower 4 bits only
05F6   00C6           01599         movwf st_year
05F7   0800           01600         movf INDF, w
05F8   390F           01601         andlw 0x0F ; mask the lower 4 bits only
05F9   00C7           01602         movwf st_month
05FA   0A84           01603         incf FSR, f ; log addr + 2
                      01604         MOVFF st_day, INDF
05FB   0800               M         movf INDF, w
05FC   00C8               M         movwf st_day
05FD   0A84           01605         incf FSR, f ; log addr + 3
                      01606         MOVFF st_hour, INDF
05FE   0800               M         movf INDF, w
05FF   00C9               M         movwf st_hour
0600   0A84           01607         incf FSR, f ; log addr + 4
                      01608         MOVFF st_min, INDF
0601   0800               M         movf INDF, w
0602   00CA               M         movwf st_min
0603   0A84           01609         incf FSR, f ; log addr + 5
                      01610         MOVFF st_sec, INDF
0604   0800               M         movf INDF, w
0605   00CB               M         movwf st_sec
0606   0A84           01611         incf FSR, f ; log addr + 6
                      01612          ; read layout[], cl_total and cl_pass
                      01613         MOVFF temp, FSR ; the address of log entry (start at + 6)
0607   0804               M         movf FSR,  w
0608   00B4               M         movwf temp
                      01614         MOVLF temp2, layout ; address of layout bytes
0609   3053               M         movlw layout
060A   00B5               M         movwf temp2
                      01615         MOVLF temp3, MAXPOS ; position counter
060B   3014               M         movlw MAXPOS
060C   00B6               M         movwf temp3
060D                  01616 readlog_layoutloop ; read layout bytes in pairs
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 47


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01617         ; read upper ribble
                      01618         MOVFF FSR, temp ; log entry
060D   0834               M         movf temp, w
060E   0084               M         movwf FSR
060F   1783           01619         bsf STATUS, IRP ; BANK2&3 indirect access
0610   0E00           01620         swapf INDF, w
0611   390F           01621         andlw 0x0F ; mask the lower 4 bits only (not 3 bits!!!!)
0612   00B7           01622         movwf temp4 ; temp4 hold the swaped layout byte temperally
                      01623         MOVFF FSR, temp2 ; get first layout byte
0613   0835               M         movf temp2, w
0614   0084               M         movwf FSR
0615   1383           01624         bcf STATUS, IRP ; BANK0&1 indirect access
                      01625         MOVFF INDF, temp4
0616   0837               M         movf temp4, w
0617   0080               M         movwf INDF
0618   1800           01626         btfsc INDF, CL_POS_BIT
0619   0AD0           01627         incf cl_total, f
061A   1880           01628         btfsc INDF, CL_FN_BIT
061B   0AD1           01629         incf cl_pass, f
061C   0AB5           01630         incf temp2, f
061D   03B6           01631         decf temp3, f
061E   1903           01632         btfsc STATUS, Z
061F   2???           01633         goto readlog_layoutnext
                      01634         ; read lower ribble
                      01635         MOVFF FSR, temp ; log entry
0620   0834               M         movf temp, w
0621   0084               M         movwf FSR
0622   1783           01636         bsf STATUS, IRP ; BANK2&3 indirect access
0623   0800           01637         movf INDF, w
0624   390F           01638         andlw 0x0F ; mask the lower 4 bits only (not 3 bits!!!!)
0625   00B7           01639         movwf temp4 ; temp4 hold the layout byte temperally
                      01640         MOVFF FSR, temp2 ; get second layout byte
0626   0835               M         movf temp2, w
0627   0084               M         movwf FSR
0628   1383           01641         bcf STATUS, IRP ; BANK0&1 indirect access
                      01642         MOVFF INDF, temp4
0629   0837               M         movf temp4, w
062A   0080               M         movwf INDF
062B   1800           01643         btfsc INDF, CL_POS_BIT
062C   0AD0           01644         incf cl_total, f
062D   1880           01645         btfsc INDF, CL_FN_BIT
062E   0AD1           01646         incf cl_pass, f
062F   0AB5           01647         incf temp2, f
0630   0AB4           01648         incf temp, f
0631   0BB6           01649         decfsz temp3, f
0632   2???           01650         goto readlog_layoutloop
0633                  01651 readlog_layoutnext
                      01652         ; calculate end time
                      01653         MOVFF end_hour, st_hour
0633   0849               M         movf st_hour, w
0634   00CC               M         movwf end_hour
                      01654         MOVFF end_min, st_min
0635   084A               M         movf st_min, w
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 48


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0636   00CD               M         movwf end_min
                      01655         MOVFF end_sec, st_sec
0637   084B               M         movf st_sec, w
0638   00CE               M         movwf end_sec
0639   084F           01656         movf runtime, w
                      01657         DIVLW .60
063A   00EA               M         movwf arith_temp
063B   303C               M         movlw .60
063C   2???               M         call divfn
063D   07CD           01658         addwf end_min, f ; end_min = st_min + runtime / .60
063E   084F           01659         movf runtime, w
                      01660         MODLW .60
063F   00EA               M         movwf arith_temp
0640   303C               M         movlw .60
0641   2???               M         call divfn
0642   086A               M         movf arith_temp, w
0643   07CE           01661         addwf end_sec, f ; end_sec = st_sec + runtime MOD .60
0644   303C           01662         movlw .60 ; test if 60s
0645   024E           01663         subwf end_sec, w ; w = end_sec - 60
0646   1C03           01664         btfss STATUS, C
0647   2???           01665         goto readlog_endsec_next; end_sec < 60, end_sec OK
0648   303C           01666         movlw .60 ; end_sec >= 60, +1min, -60s
0649   02CE           01667         subwf end_sec, f
064A   0ACD           01668         incf end_min, f
064B                  01669 readlog_endsec_next
064B   303C           01670         movlw .60 ; test if 60min
064C   024D           01671         subwf end_min, w
064D   1C03           01672         btfss STATUS, C
064E   2???           01673         goto readlog_next ; end_min < 60, end_min OK, end_hour should OK
064F   303C           01674         movlw .60 ; end_min >= 60, +1h, -60min
0650   02CD           01675         subwf end_min, f
0651   0ACC           01676         incf end_hour, f
0652   3018           01677         movlw .24 ; test if 24h
0653   024C           01678         subwf end_hour, w
0654   1C03           01679         btfss STATUS, C
0655   2???           01680         goto readlog_next
0656   3018           01681         movlw .24 ; >24h, -24h
0657   02CC           01682         subwf end_hour, f
0658                  01683 readlog_next
                      01684         ; cl_fail = cl_total - cl_pass
0658   0851           01685         movf cl_pass, w
0659   0250           01686         subwf cl_total, w
065A   00D2           01687         movwf cl_fail
065B   1383           01688         bcf STATUS, IRP ; back to BANK0&1 indirect access
065C   0008           01689         return
                      01690 ;*******************************************************************************
                      01691 ; "addsec": Add One Second Function
                      01692 ; Func: Add one second to the second byte of a timer,!!!!!!!!!!!!!!
                      01693 ; increase minute and hour bytes if necessary,
                      01694 ; carry out if day increment occur
                      01695 ; Input: W = Address of the second byte, min byte and hour byte
                      01696 ; should be at address W-1 and W-2, respectively
                      01697 ; Output: set STATUS C for day carry out
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 49


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01698 ; Affect: W, FSR
                      01699 ; Runtime: 3.6us/6.4us/9.2us/10.0us
                      01700 ;*******************************************************************************
065D                  01701 addsec
065D   0084           01702         movwf FSR
065E   0A80           01703         incf INDF, f ; +1sec
065F   303C           01704         movlw .60
0660   0200           01705         subwf INDF, w ; W = INDF - 60, test if 60s
0661   1C03           01706         btfss STATUS, C
0662   0008           01707         return ; INDF < 60, C==0, function done
0663   0180           01708         clrf INDF ; >=60s, clear sec
0664   0384           01709         decf FSR, f ; now FSR has address of min byte
0665   0A80           01710         incf INDF, f ; +1min
0666   303C           01711         movlw .60
0667   0200           01712         subwf INDF, w ; W = INDF - 60, test if 60min
0668   1C03           01713         btfss STATUS, C
0669   0008           01714         return ; INDF < 60, C==0, function done
066A   0180           01715         clrf INDF ; >=60min, clear min
066B   0384           01716         decf FSR, f ; now FSR has address of hour byte
066C   0A80           01717         incf INDF, f ; +1hour
066D   3018           01718         movlw .24
066E   0200           01719         subwf INDF, w ; W = INDF - 24, test if 24hour
066F   1C03           01720         btfss STATUS, C
0670   0008           01721         return ; INDF < 24, C==0, function done
0671   0180           01722         clrf INDF ; >=24h, clear hour
0672   0008           01723         return ; C has been set
                      01724 ;*******************************************************************************
                      01725 ; "addday": Add One Day Function
                      01726 ; Func: Add one day to the day byte of a timer,
                      01727 ; increase month and year bytes if necessary, !!!!unfinish
                      01728 ; Input: W = Address of the day byte, month byte and year byte
                      01729 ; should be at address W-1 and W-2, respectively
                      01730 ; Output: None
                      01731 ; Affect: W, STATUS, FSR
                      01732 ; Runtime: 3.6us/6.4us/8.0us
                      01733 ;*******************************************************************************
0673                  01734 addday
0673   0084           01735         movwf FSR
0674   0A80           01736         incf INDF, f ; +1day
0675   301F           01737         movlw .31 ; assume 1 month always= 30 days !!!!
0676   0200           01738         subwf INDF, w ; W = INDF - 31, test if over 30days
0677   1C03           01739         btfss STATUS, C
0678   0008           01740         return ; INDF < 31, C==0, function done
0679   0180           01741         clrf INDF ; >=31s, clear day
Message[305]: Using default destination of 1 (file).
067A   0A80           01742         incf INDF ; day default at 1
067B   0384           01743         decf FSR, f ; now FSR has address of month byte
067C   0A80           01744         incf INDF, f ; +1month
067D   300D           01745         movlw .13
067E   0200           01746         subwf INDF, w ; W = INDF - 13, test if over 12month
067F   1C03           01747         btfss STATUS, C
0680   0008           01748         return ; INDF < 13, C==0, function done
0681   0180           01749         clrf INDF ; >=13month, clear month
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 50


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Message[305]: Using default destination of 1 (file).
0682   0A80           01750         incf INDF ; month default at 1
0683   0384           01751         decf FSR, f ; now FSR has address of year byte
0684   0A80           01752         incf INDF, f ; +1year
0685   0008           01753         return
                      01754 ;*******************************************************************************
                      01755 ; "divfn": Byte Integer Division Function
                      01756 ; Func: Devide temp by W and store result in W, not efficient
                      01757 ; Input: Temp = Dividend, W = Dividor
                      01758 ; Output: W = Quotient, arith_temp = reminder,
                      01759 ; set STATUS Z for zero quotient, C for error
                      01760 ; Affect: arith_temp2
                      01761 ;*******************************************************************************
0686                  01762 divfn
0686   3E00           01763         addlw 0x00
0687   1403           01764         bsf STATUS, C ; set carry in case of error
0688   1903           01765         btfsc STATUS, Z ; if zero
0689   0008           01766         return ; return (error C,Z)
068A   01EB           01767         clrf arith_temp2
068B                  01768 divfn_loop
068B   02EA           01769         subwf arith_temp, f
068C   1C03           01770         btfss STATUS, C
068D   2???           01771         goto divfn_next
068E   0AEB           01772         incf arith_temp2, f
068F   2???           01773         goto divfn_loop
0690                  01774 divfn_next
0690   07EA           01775         addwf arith_temp, f
0691   086B           01776         movf arith_temp2, w
0692   0008           01777         return
                      01778 ;*******************************************************************************
                      01779 ; "mulfn": Byte Integer Multiplication Function
                      01780 ; Func: Multiple W by temp and return result in W, not efficient
                      01781 ; Input: Temp, W
                      01782 ; Output: W = Result, set STATUS Z for zero, C for overflow
                      01783 ; Affect: arith_temp, arith_temp2
                      01784 ;*******************************************************************************
0693                  01785 mulfn
0693   1003           01786         bcf STATUS, C ; clr C bit for arith_temp == 0
0694   00EB           01787         movwf arith_temp2 ; store W in arith_temp2
0695   3000           01788         movlw 0x00 ; W = 0 + arith_tempp * arith_temp2
0696   08EA           01789         movf arith_temp, f
0697   1903           01790         btfsc STATUS, Z
0698   0008           01791         return ; arith_temp == 0, return 0
0699                  01792 mulfn_loop
0699   076B           01793         addwf arith_temp2, w
069A   1803           01794         btfsc STATUS, C
069B   2???           01795         goto mulfn_overflow ; W>255 overflow
069C   0BEA           01796         decfsz arith_temp, f
069D   2???           01797         goto mulfn_loop
069E                  01798 mulfn_overflow
069E   0008           01799         return
3F72                  01800         end
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 51


SYMBOL TABLE
  LABEL                             VALUE 

ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
BANK0                             
BANK00                            
BANK1                             
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BRGH                              00000002
C                                 00000000
CALC_POS                          
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1                             00000015
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2                             0000001B
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CKE                               00000006
CKP                               00000004
CL_ERR_BIT                        2
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 52


SYMBOL TABLE
  LABEL                             VALUE 

CL_FN_BIT                         1
CL_POS_BIT                        0
COLS                              00000005
COPY_DEC1                         
COPY_DEC2                         
COPY_DEC3                         
COPY_LAYOUT                       
COPY_STRING                       
CREN                              00000004
CSRC                              00000007
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DCDOWNDELAY                       0000001E
DEBUG                             
DIVLW                             
D_A                               00000005
D_NOT_A                           00000005
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
F                                 00000001
FALSE                             0x00
FB_ROW4                           PORTC, 7
FB_TOP                            PORTC, 5
FERR                              00000002
FSR                               00000004
FSR_temp                          00000002
GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
GO_NOT_DONE                       00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
INDF                              00000000
INITVAL_ADCON0                    B'10000001'
INITVAL_ADCON1                    B'00000010'
INITVAL_OPTREG                    B'10000101'
INITVAL_TRISA                     B'00101111'
INITVAL_TRISB                     B'11110010'
INITVAL_TRISC                     B'10100000'
INITVAL_TRISD                     B'00000000'
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 53


SYMBOL TABLE
  LABEL                             VALUE 

INITVAL_TRISE                     B'00000000'
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRLED                             PORTC, 2
IRLED_OFF                         
IRLED_ON                          
IRP                               00000007
KEYPAD_DA                         PORTB, 1
LCD_E                             PORTD, 3
LCD_PORT                          PORTD
LCD_RS                            PORTD, 2
LCD_clear                         00000000
LCD_init                          00000000
LCD_line2                         00000000
LCD_out                           00000000
LCD_wt                            00000000
LCDline                           00000023
LIGHTAVGX                         00000004
LOGLENGTH                         00000010
MAXCLINROW                        00000003
MAXLINE                           00000009
MAXLOG                            0000000C
MAXLOGBANK                        00000006
MAXPOS                            00000014
ML_finish                         000002E3
ML_finish_0                       000003A9
ML_finish_1                       000003AC
ML_hdinit                         000002A0
ML_hdinit_0                       000002EE
ML_hdinit_1                       000002F1
ML_noreport                       000002B9
ML_noreport_0                     0000031E
ML_noreport_1                     00000321
ML_realtime                       000002AE
ML_realtime_0                     000002F4
ML_realtime_1                     0000030A
ML_report                         000002C4
ML_report_0                       00000324
ML_report_1                       0000033F
ML_report_10                      0000039E
ML_report_2                       00000355
ML_report_3                       0000036B
ML_report_4                       00000375
ML_report_5                       0000037D
ML_report_6                       0000038C
ML_report_7                       0000038F
ML_report_8                       00000394
ML_report_9                       00000399
ML_rtcinit                        000002AB
ML_run                            000002D8
ML_run_0                          000003A3
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 54


SYMBOL TABLE
  LABEL                             VALUE 

ML_run_1                          000003A6
MODLW                             
MOVFF                             
MOVLF                             
MULLW                             
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
NULL                              0x00
OBF                               00000006
OERR                              00000001
OPTION_REG                        00000081
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PHASE_FINISH                      6
PHASE_HDINIT                      0
PHASE_NOREPORT                    3
PHASE_REALTIME                    2
PHASE_REPORT                      4
PHASE_RTCINIT                     1
PHASE_RUN                         5
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PRINT_DOT                         
PS0                               00000000
PS1                               00000001
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 55


SYMBOL TABLE
  LABEL                             VALUE 

PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
RD0                               00000000
RD1                               00000001
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
READ_WRITE                        00000002
ROWS                              00000004
RP0                               00000005
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 56


SYMBOL TABLE
  LABEL                             VALUE 

RP1                               00000006
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SEN                               00000000
SMOTOR_EN                         PORTE, 2
SMOTOR_S0                         PORTD, 0
SMOTOR_S1                         PORTD, 1
SMOTOR_S2                         PORTE, 0
SMOTOR_S3                         PORTE, 1
SMOTOR_SPD_F                      00000006
SMOTOR_STEPS                      0000001C
SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
STOP_BUT                          0x0B
STORE_LIGHT                       
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TABLE                             
THD_BG                            00000005
THD_CL3LED                        00000050
THD_IRLED                         0000001C
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 57


SYMBOL TABLE
  LABEL                             VALUE 

TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1                              0000000E
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000088
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000089
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 58


SYMBOL TABLE
  LABEL                             VALUE 

TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TRUE                              0xFF
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
UA                                00000001
VMOTOR_C0                         PORTC, 0
VMOTOR_C1                         PORTC, 1
W                                 00000000
WCOL                              00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_BOREN_OFF                        00003FBF
_BOREN_ON                         00003FFF
_CONFIG                           00002007
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00000FCF
_CP_HALF                          00001FDF
_CP_OFF                           00003FFF
_CP_UPPER_256                     00002FEF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_DEVID1                           00002006
_FOSC_EXTRC                       00003FFF
_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 59


SYMBOL TABLE
  LABEL                             VALUE 

_WDTE_ON                          00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_ENABLE_OFF                   00003DFF
_WRT_ENABLE_ON                    00003FFF
_WRT_OFF                          00003DFF
_WRT_ON                           00003FFF
_XT_OSC                           00003FFD
__16F877                          00000001
addday                            00000673
addsec                            0000065D
advancerow                        00000553
advancerow_backwardloop           00000573
advancerow_end                    00000581
advancerow_forwardloop            0000055C
arg                               0000003B
arg2                              0000003C
arith_temp                        0000006A
arith_temp2                       0000006B
calcfunc                          000004AF
calcfunc_C1false                  000004C5
calcfunc_C1next                   000004C6
calcfunc_C2false                  000004D6
calcfunc_C2next                   000004D7
calcfunc_FNfalse                  000004F0
calcfunc_POSfalse                 000004E3
calcfunc_loop                     000004B6
calcpos                           00000498
calcpos_loop                      0000049A
calcpos_next                      000004A7
calcruntime                       00000508
calcruntime_loop                  00000517
calcruntime_next1                 0000050D
calcruntime_next2                 00000514
calcruntime_next3                 0000051C
calcruntime_overflow              0000051E
char_keynumber                    000000D9
char_layout                       000000D1
char_slash                        000000E9
cl_fail                           00000052
cl_pass                           00000051
cl_total                          00000050
copydec                           000003E0
copydec_copyhundreds              000003EB
copydec_copytens                  000003FF
copydec_ending                    0000040A
copydec_ones                      00000402
copydec_tens                      000003F0
copylayout                        000003C0
copylayout_charloop               000003CD
copylayout_next                   000003C8
copylayout_startloop              000003C5
copystring                        000003B6
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 60


SYMBOL TABLE
  LABEL                             VALUE 

copystring_loop                   000003B7
delay100ms                        00000000
delay1sl                          00000000
delay50us                         00000000
delay5ms                          00000000
delayX100msm                      00000000
delayX5msm                        00000000
display                           0000027F
divfn                             00000686
divfn_loop                        0000068B
divfn_next                        00000690
end_hour                          0000004C
end_min                           0000004D
end_sec                           0000004E
init                              00000125
init_pic                          0000012F
int_rb_end                        0000011D
int_rb_skip                       0000011E
int_tmr0_end                      00000107
int_tmr0_skip                     00000108
interrupt                         000000F0
keypad_timeout                    00000279
keypoll                           000000EC
keyresp                           00000201
keyresp_next                      0000021B
kp_to_nonewsec                    0000027E
layout                            00000053
ledcontrol                        0000053E
light_bg                          000000B0
light_cl                          000000BA
light_off                         000000BF
light_pos                         000000B5
lightsensor                       00000521
lightsensor_loop_avg              0000052C
lightsensor_loop_col              00000525
lightsensor_poll                  0000052E
line_num                          00000022
literal                           00000005
literal_addr                      0000003D
log_next                          00000069
log_total                         00000068
main                              000000EB
makeline                          0000028D
movedown                          00000543
moveup                            0000054B
moveup_poll                       0000054E
mulfn                             00000693
mulfn_loop                        00000699
mulfn_overflow                    0000069E
newsec                            0000006C
phase                             00000020
readlog                           000005DB
readlog_endsec_next               0000064B
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 61


SYMBOL TABLE
  LABEL                             VALUE 

readlog_layoutloop                0000060D
readlog_layoutnext                00000633
readlog_next                      00000658
realtime                          0000021F
report                            00000223
report_last                       0000022A
report_next                       00000240
report_num                        00000021
reset_hardware                    0000014F
reset_realtime                    0000015F
reset_rt_hms                      000001BE
reset_rt_hms0                     000001DA
reset_rt_hms1                     000001E1
reset_rt_hms2                     000001E5
reset_rt_hms3                     000001EC
reset_rt_hms4                     000001F0
reset_rt_hms5                     000001F7
reset_rt_hmsrl                    000001FA
reset_rt_ymd                      00000174
reset_rt_ymd0                     00000190
reset_rt_ymd1                     00000197
reset_rt_ymd2                     0000019B
reset_rt_ymd3                     000001A2
reset_rt_ymd4                     000001A6
reset_rt_ymd5                     000001AD
reset_rt_ymdrl                    000001B0
reset_software                    00000146
result_addr                       0000003F
rowleft                           0000003E
rt_counter                        00000003
rt_day                            00000042
rt_hour                           00000043
rt_min                            00000044
rt_month                          00000041
rt_sec                            00000045
rt_year                           00000040
run                               00000415
run_clearlayoutloop               00000425
run_end                           0000048B
run_init_smotornext               00000431
run_loop                          00000440
run_nextRAM_next                  00000471
run_nextRAM_next2                 00000481
run_nextRAM_reverse               00000470
run_nextRAM_reverse2              00000480
run_noextrarow                    0000047A
runtime                           0000004F
scroll_down                       0000025C
scroll_up                         00000254
smotor_dir                        00000067
st_day                            00000048
st_hour                           00000049
st_min                            0000004A
MPASM  5.48                       TEST2_1.ASM   2-20-2013  17:15:49         PAGE 62


SYMBOL TABLE
  LABEL                             VALUE 

st_month                          00000047
st_sec                            0000004B
st_year                           00000046
startrun                          00000265
status_temp                       00000001
stop                              0000011C
stoprun                           00000278
str_colon                         00000046
str_dash                          00000044
str_dot                           000000B0
str_emerstop                      000000C1
str_enterhms                      00000033
str_enterymd                      00000023
str_entry                         00000048
str_fail                          00000080
str_finish                        0000005C
str_init                          00000009
str_insp_fin                      000000B2
str_layout                        00000088
str_layout1                       00000090
str_layout2                       00000098
str_layout3                       0000009C
str_layout4                       000000A0
str_noreport                      00000019
str_null                          000000D0
str_pass                          00000079
str_running                       000000A8
str_runtime                       00000065
str_s                             0000006F
str_start                         00000054
str_total                         00000071
str_yearhead                      00000041
table_temp                        00000004
temp                              00000034
temp2                             00000035
temp3                             00000036
temp4                             00000037
temp5                             00000038
temp6                             00000039
temp7                             0000003A
unused_key                        0000021B
w_temp                            00000000
wait_release                      0000021B
writeline                         0000040D
writeline_loop                    0000040F
writelog                          00000583
writelog_layoutloop               000005B0
writelog_layoutnext               000005CC

Errors   :     0
Warnings :   125 reported,     0 suppressed
Messages :     9 reported,     0 suppressed

